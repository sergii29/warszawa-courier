<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Warszawa Courier - Simulator</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <style>
        :root {
            --bg-color: #f4f4dc;
            --grid-color: #dadab9;
            --accent-lime: #c8ff00;
            --dark: #1a1a1a;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            font-family: sans-serif; background: var(--bg-color);
            overflow: hidden; touch-action: none;
        }

        /* –ú–µ–ª–∫–∞—è —Å–µ—Ç–∫–∞ */
        #game-world {
            position: relative;
            width: 100%; height: 100vh;
            background-image: 
                linear-gradient(var(--grid-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: 15px 15px; /* –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ */
            transition: background-position 0.1s linear;
        }

        #ui-top {
            position: absolute; top: 20px; width: 100%;
            display: flex; justify-content: center; z-index: 100;
        }

        .balance {
            background: white; padding: 8px 20px;
            border-radius: 20px; font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        /* –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–π –≤–µ–ª–æ—Å–∏–ø–µ–¥ */
        #player {
            position: absolute;
            width: 20px; height: 20px;
            background: var(--accent-lime);
            border: 2px solid black;
            border-radius: 4px;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 50;
            display: flex; align-items: center; justify-content: center;
            font-size: 10px;
        }

        /* –û–∫–Ω–æ –∑–∞–∫–∞–∑–∞ */
        #order-modal, #event-modal {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: white; border-radius: 15px;
            padding: 20px; width: 80%; text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 200; display: none;
        }

        /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        #controls {
            position: absolute; bottom: 30px; width: 100%;
            display: flex; flex-direction: column; align-items: center; gap: 10px;
        }

        .btn {
            width: 85%; padding: 15px; border-radius: 12px;
            border: none; font-weight: bold; font-size: 1rem;
            cursor: pointer; text-transform: uppercase;
        }

        .btn-online { background: var(--accent-lime); color: black; }
        .btn-gas { background: #ff4500; color: white; display: none; height: 80px; border-radius: 50%; width: 80px; }
        
        .event-btn { background: var(--dark); color: white; margin-top: 5px; width: 100%; }

        /* –ú–∞—Ä–∫–µ—Ä —Ü–µ–ª–∏ */
        #target {
            position: absolute; width: 15px; height: 15px;
            background: red; border-radius: 50%; display: none;
        }
    </style>
</head>
<body>

<div id="ui-top">
    <div class="balance"><span id="cash">0,00</span> PLN</div>
</div>

<div id="game-world">
    <div id="player">üö≤</div>
    <div id="target"></div>
</div>

<div id="order-modal">
    <h3 id="res-name">–†–µ—Å—Ç–æ—Ä–∞–Ω: Zapiecek</h3>
    <p>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: <span id="dist">0</span> –∫–ª.</p>
    <button class="btn btn-online" onclick="startDelivery()">–ü–æ–µ—Ö–∞—Ç—å –∑–∞ –∑–∞–∫–∞–∑–æ–º</button>
</div>

<div id="event-modal">
    <h3 id="event-title">–í–ø–µ—Ä–µ–¥–∏ –ü–æ–ª–∏—Ü–∏—è!</h3>
    <button class="btn event-btn" onclick="handleEvent('bribe')">–î–∞—Ç—å –≤–∑—è—Ç–∫—É (10 PLN)</button>
    <button class="btn event-btn" onclick="handleEvent('bypass')">–û–±—ä–µ—Ö–∞—Ç—å (—Ç—Ä–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏)</button>
</div>

<div id="controls">
    <button id="main-btn" class="btn btn-online" onclick="goOnline()">–í—ã–π—Ç–∏ –≤ –æ–Ω–ª–∞–π–Ω</button>
    <button id="gas-btn" class="btn btn-gas" onmousedown="hitGas()">–ì–ê–ó</button>
</div>

<script>
    // Firebase Init (–∏–∑ —Ç–≤–æ–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞)
    const firebaseConfig = {
        apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk",
        authDomain: "warszawa-courier.firebaseapp.com",
        databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "warszawa-courier"
    };
    firebase.initializeApp(firebaseConfig);

    const restaurants = ["Barn Burger", "Zapiecek", "Hala Koszyki", "Manekin", "Krowarzywa"];
    let isOnline = false;
    let distanceToTarget = 0;
    let worldOffset = 0;

    function goOnline() {
        const res = restaurants[Math.floor(Math.random() * restaurants.length)];
        document.getElementById('res-name').innerText = "–†–µ—Å—Ç–æ—Ä–∞–Ω: " + res;
        distanceToTarget = Math.floor(Math.random() * 50) + 20;
        document.getElementById('dist').innerText = distanceToTarget;
        document.getElementById('order-modal').style.display = 'block';
        document.getElementById('main-btn').style.display = 'none';
    }

    function startDelivery() {
        document.getElementById('order-modal').style.display = 'none';
        document.getElementById('gas-btn').style.display = 'block';
    }

    function hitGas() {
        if (distanceToTarget <= 0) return;

        // –®–∞–Ω—Å —Å–æ–±—ã—Ç–∏—è (10%)
        if (Math.random() < 0.1) {
            triggerEvent();
            return;
        }

        // –î–≤–∏–∂–µ–Ω–∏–µ –º–∏—Ä–∞ (–ø—Ä—ã–∂–æ–∫ –ø–æ –∫–ª–µ—Ç–∫–∞–º)
        distanceToTarget--;
        worldOffset += 15; // –†–∞–∑–º–µ—Ä –æ–¥–Ω–æ–π –∫–ª–µ—Ç–∫–∏
        document.getElementById('game-world').style.backgroundPosition = `0px ${worldOffset}px`;
        
        if (distanceToTarget <= 0) {
            finishDelivery();
        }
    }

    function triggerEvent() {
        const events = ["–ü–æ–ª–∏—Ü–∏—è!", "–ü—Ä–æ–±–∫–∞!", "–†–µ–º–æ–Ω—Ç –¥–æ—Ä–æ–≥–∏!"];
        document.getElementById('event-title').innerText = events[Math.floor(Math.random() * events.length)];
        document.getElementById('event-modal').style.display = 'block';
        document.getElementById('gas-btn').disabled = true;
    }

    function handleEvent(type) {
        document.getElementById('event-modal').style.display = 'none';
        document.getElementById('gas-btn').disabled = false;
        alert(type === 'bribe' ? "–í—ã –¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å." : "–í—ã –ø–æ—Ç–µ—Ä—è–ª–∏ –≤—Ä–µ–º—è –Ω–∞ –æ–±—ä–µ–∑–¥.");
    }

    function finishDelivery() {
        alert("–ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω!");
        document.getElementById('gas-btn').style.display = 'none';
        document.getElementById('main-btn').style.display = 'block';
        document.getElementById('main-btn').innerText = "–ò—Å–∫–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑";
        // –¢—É—Ç –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –¥–µ–Ω–µ–≥ –≤ Firebase
    }
</script>

</body>
</html>
