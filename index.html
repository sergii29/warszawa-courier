<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Courier Partner</title>

<style>
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
  margin: 0;
  background: #f4f6f8;
  font-family: system-ui, sans-serif;
  color: #0b1f33;
}

#app {
  max-width: 420px;
  margin: auto;
  padding: 12px;
}

.header {
  text-align: center;
  font-weight: 700;
  font-size: 20px;
  color: #00aaff;
  margin-bottom: 10px;
}

/* MAP */
#map {
  position: relative;
  height: 220px;
  background: #eaf6ff;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 8px 20px rgba(0,0,0,0.08);
  margin-bottom: 12px;
}

.point {
  position: absolute;
  font-size: 22px;
}

#courier { left: 10px; top: 100px; transition: .2s; }
#restaurant { right: 20px; top: 40px; }
#client { right: 20px; bottom: 40px; }

.weather {
  position: absolute;
  top: 8px;
  left: 8px;
  background: rgba(255,255,255,0.85);
  padding: 4px 8px;
  border-radius: 8px;
  font-size: 13px;
}

/* PANELS */
.panel {
  background: #fff;
  border-radius: 14px;
  padding: 12px;
  margin-bottom: 10px;
  box-shadow: 0 6px 14px rgba(0,0,0,0.06);
}

.stat {
  display: flex;
  justify-content: space-between;
  font-size: 14px;
  margin: 4px 0;
}

/* BUTTONS */
button {
  width: 100%;
  padding: 16px;
  margin-top: 8px;
  border: none;
  border-radius: 14px;
  font-size: 16px;
  font-weight: 600;
  background: #00aaff;
  color: #fff;
}

button.gray {
  background: #dfe8ee;
  color: #4a5b68;
}

button:active { transform: scale(0.97); }

.status {
  text-align: center;
  font-weight: 500;
}
</style>
</head>

<body>
<div id="app">

<div class="header">Courier Partner</div>

<div id="map">
  <div class="weather" id="weather">‚òÄÔ∏è –Ø—Å–Ω–æ</div>
  <div class="point" id="courier">üö¥</div>
  <div class="point" id="restaurant">üçî</div>
  <div class="point" id="client">üè†</div>
</div>

<div class="panel">
  <div class="stat">üèÖ –£—Ä–æ–≤–µ–Ω—å <span id="level">1</span></div>
  <div class="stat">‚≠ê –û–ø—ã—Ç <span id="xp">0</span></div>
</div>

<div class="panel">
  <div class="stat">üí∞ –î–µ–Ω—å–≥–∏ <span id="money">0</span> z≈Ç</div>
  <div class="stat">‚ö° –≠–Ω–µ—Ä–≥–∏—è <span id="energy">100</span>%</div>
  <div class="stat">üôÇ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ <span id="mood">70</span>%</div>
  <div class="stat">üö≤ –í–µ–ª <span id="bike">100</span>%</div>
</div>

<div class="panel status" id="status">–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤‚Ä¶</div>

<div class="panel">
  <button id="mainBtn" onclick="action()">üì¶ –ü—Ä–∏–Ω—è—Ç—å –∑–∞–∫–∞–∑</button>
</div>

</div>

<script>
/* ===== –°–û–°–¢–û–Ø–ù–ò–ï ===== */
let s = JSON.parse(localStorage.getItem("partner_v2")) || {
  xp:0, level:1, money:0,
  energy:100, mood:70, bike:100,
  phase:"idle",
  weather:"sun"
};

/* ===== –£–†–û–í–ù–ò ===== */
function calcLevel(xp){
  return Math.min(150, Math.floor(Math.pow(xp,0.45)));
}

/* ===== –ü–û–ì–û–î–ê ===== */
function newWeather(){
  s.weather = Math.random()<0.3 ? "rain" : "sun";
  weather.innerText = s.weather==="rain" ? "üåß –î–æ–∂–¥—å" : "‚òÄÔ∏è –Ø—Å–Ω–æ";
}

/* ===== –ì–ï–ô–ú–ü–õ–ï–ô ===== */
function action(){
  if(s.energy<=0 || s.bike<=0) return;

  if(s.phase==="idle"){
    s.phase="toRestaurant";
    status.innerText="–ï–¥–µ—à—å –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω";
    moveCourier(280,40);
    mainBtn.innerText="üö¥ –ï—Ö–∞—Ç—å";
  }
  else if(s.phase==="toRestaurant"){
    ride();
    s.phase="toClient";
    status.innerText="–í–µ–∑—ë—à—å –∑–∞–∫–∞–∑ –∫–ª–∏–µ–Ω—Ç—É";
    moveCourier(280,150);
  }
  else{
    ride();
    let income = 12 + Math.floor(s.level*0.6);
    s.money+=income;
    s.xp+=income;
    s.level=calcLevel(s.xp);
    s.phase="idle";
    status.innerText="–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤‚Ä¶";
    mainBtn.innerText="üì¶ –ü—Ä–∏–Ω—è—Ç—å –∑–∞–∫–∞–∑";
    moveCourier(10,100);
    newWeather();
  }

  save();update();
}

function ride(){
  let weatherPenalty = s.weather==="rain" ? 1.4 : 1;
  s.energy-=5*weatherPenalty;
  s.bike-=3*weatherPenalty;
  s.mood-=2*weatherPenalty;
}

/* ===== UI ===== */
function moveCourier(x,y){
  courier.style.left=x+"px";
  courier.style.top=y+"px";
}
function update(){
  level.innerText=s.level;
  xp.innerText=s.xp;
  money.innerText=s.money;
  energy.innerText=Math.max(0,Math.floor(s.energy));
  mood.innerText=Math.max(0,Math.floor(s.mood));
  bike.innerText=Math.max(0,Math.floor(s.bike));
}
function save(){localStorage.setItem("partner_v2",JSON.stringify(s));}

newWeather();update();
</script>

</body>
</html>
