<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Courier Life ‚Äî Warszawa</title>

<style>
body {
  margin: 0;
  background: #0b0b0b;
  color: #eaeaea;
  font-family: system-ui, Arial;
}
#wrap {
  max-width: 420px;
  margin: auto;
  padding: 14px;
}
canvas {
  width: 100%;
  height: 160px;
  background: linear-gradient(#1a1a1a,#050505);
  border-radius: 12px;
  margin-bottom: 12px;
}
.panel {
  background: rgba(25,25,25,0.95);
  border-radius: 14px;
  padding: 12px;
  margin-bottom: 10px;
}
.stat {
  display: flex;
  justify-content: space-between;
  font-size: 14px;
}
button {
  width: 100%;
  padding: 14px;
  margin-top: 6px;
  border: none;
  border-radius: 12px;
  font-size: 16px;
  background: linear-gradient(135deg,#2979ff,#00b0ff);
  color: white;
}
button.red {
  background: linear-gradient(135deg,#b71c1c,#ff5252);
}
.log {
  font-size: 14px;
  line-height: 1.4;
  min-height: 80px;
  opacity: .9;
}
</style>
</head>

<body>
<div id="wrap">

<canvas id="scene"></canvas>

<div class="panel">
  <div class="stat">–£—Ä–æ–≤–µ–Ω—å <span id="level">1</span></div>
  <div class="stat">–û–ø—ã—Ç <span id="xp">0</span></div>
</div>

<div class="panel">
  <div class="stat">üí∞ –î–µ–Ω—å–≥–∏ <span id="money">0</span> z≈Ç</div>
  <div class="stat">üí∏ –î–æ–ª–≥ <span id="debt">0</span> z≈Ç</div>
</div>

<div class="panel">
  <div class="stat">‚ö° –≠–Ω–µ—Ä–≥–∏—è <span id="energy">100</span>%</div>
  <div class="stat">üò§ –°—Ç—Ä–µ—Å—Å <span id="stress">10</span>%</div>
  <div class="stat">üôÇ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ <span id="mood">60</span>%</div>
</div>

<div class="panel">
  <button onclick="startDay()">üö¶ –ù–∞—á–∞—Ç—å –¥–µ–Ω—å</button>
  <button onclick="doDelivery()">üì¶ –î–æ—Å—Ç–∞–≤–∫–∞</button>
  <button class="red" onclick="endDay()">üåô –ó–∞–∫–æ–Ω—á–∏—Ç—å –¥–µ–Ω—å</button>
</div>

<div class="panel log" id="log">
–ì–æ—Ä–æ–¥ –¥—ã—à–∏—Ç. –¢—ã —Å–º–æ—Ç—Ä–∏—à—å –Ω–∞ –Ω–µ–±–æ –∏ –∂–¥—ë—à—å –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑.
</div>

</div>

<script>
/* ================== –°–û–•–†–ê–ù–ï–ù–ò–ï ================== */
let p = JSON.parse(localStorage.getItem("courier_life")) || {
  xp:0, level:1, money:0, debt:0,
  energy:100, stress:10, mood:60,
  burnout:0, day:1, onDay:false
};

/* ================== –ì–û–†–û–î ================== */
let city = {
  hour: 8,
  weather: "clear", // clear rain night
  demand: 1,
  pressure: 1
};

/* ================== –§–û–†–ú–£–õ–´ ================== */
function calcLevel(xp){return Math.min(150,Math.floor(Math.pow(xp,0.45)));}
function clamp(){p.energy=Math.max(0,Math.min(100,p.energy));p.mood=Math.max(0,Math.min(100,p.mood));}

/* ================== –î–ï–ù–¨ ================== */
function startDay(){
  if(p.onDay){log("–¢—ã —É–∂–µ –≤ —Ä–∞–±–æ—Ç–µ.");return;}
  p.onDay=true;
  city.hour=8;
  city.weather=Math.random()<0.3?"rain":"clear";
  log("–¢—ã –≤—ã—Ö–æ–¥–∏—à—å. –ü–æ–≥–æ–¥–∞: "+(city.weather==="rain"?"–¥–æ–∂–¥—å":"—è—Å–Ω–æ"));
  save();update();
}

/* ================== –î–û–°–¢–ê–í–ö–ê ================== */
function doDelivery(){
  if(!p.onDay){log("–¢—ã –µ—â—ë –Ω–µ –Ω–∞—á–∞–ª –¥–µ–Ω—å.");return;}
  if(p.energy<=0){log("–¢—ã –≤—ã–≥–æ—Ä–µ–ª —Ñ–∏–∑–∏—á–µ—Å–∫–∏.");return;}

  city.hour++;
  city.demand = city.hour>=11&&city.hour<=14 || city.hour>=18?1.6:1.0;

  let dist = rnd(1,7);
  let fatigue = (100-p.energy)/100;
  let moodMod = p.mood/100;
  let income = Math.floor(dist*9*city.demand*moodMod*(1-fatigue));

  let tax = Math.floor(income*0.12);
  let fine = Math.random()<0.15?rnd(20,60):0;

  p.money += income - tax - fine;
  p.xp += income;
  p.energy -= dist*7;
  p.stress += rnd(3,6);
  p.mood -= fine?8:3;

  if(fine){log("‚ö†Ô∏è –ö–æ–Ω—Ñ–ª–∏–∫—Ç. –®—Ç—Ä–∞—Ñ "+fine+" z≈Ç.");}
  else{log("üì¶ –î–æ—Å—Ç–∞–≤–∫–∞. +" + (income-tax) + " z≈Ç.");}

  p.level = calcLevel(p.xp);
  clamp();save();update();
}

/* ================== –ö–û–ù–ï–¶ –î–ù–Ø ================== */
function endDay(){
  p.onDay=false;
  p.energy+=40;
  p.stress-=20;
  p.mood+=10;
  p.day++;
  log("üåô –î–µ–Ω—å –æ–∫–æ–Ω—á–µ–Ω. –¢—ã –º–æ–ª—á–∏—à—å –∏ —Å–º–æ—Ç—Ä–∏—à—å –≤ –ø–æ—Ç–æ–ª–æ–∫.");
  clamp();save();update();
}

/* ================== CANVAS ================== */
const c=document.getElementById("scene"),ctx=c.getContext("2d");
function draw(){
  c.width=c.offsetWidth;c.height=c.offsetHeight;
  ctx.clearRect(0,0,c.width,c.height);
  ctx.fillStyle=city.weather==="rain"?"#223":"#111";
  ctx.fillRect(0,0,c.width,c.height);
  ctx.fillStyle="#4fc3f7";
  ctx.fillRect((Date.now()/20)%c.width,100,30,10);
  requestAnimationFrame(draw);
}
draw();

/* ================== UI ================== */
function update(){
  level.innerText=p.level;xp.innerText=p.xp;
  money.innerText=p.money;debt.innerText=p.debt;
  energy.innerText=p.energy;stress.innerText=p.stress;
  mood.innerText=p.mood;
}
function log(t){document.getElementById("log").innerText=t;}
function save(){localStorage.setItem("courier_life",JSON.stringify(p));}
function rnd(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
update();
</script>

</body>
</html>
