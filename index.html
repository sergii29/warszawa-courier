<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Warsaw Courier Sim</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
html,body{margin:0;padding:0;height:100%;background:#111;color:#fff;font-family:system-ui;overflow:hidden}
#map{height:100%;width:100%}

.topbar{
position:absolute;top:10px;left:10px;right:10px;
display:flex;justify-content:space-between;z-index:1000
}
.btn{
background:#fff;color:#000;border:none;border-radius:50%;
width:44px;height:44px;font-size:18px;cursor:pointer
}
.balance{
background:rgba(0,0,0,.7);padding:10px 15px;border-radius:20px
}

#pedal{
position:absolute;bottom:20px;left:50%;
transform:translateX(-50%);
padding:20px 40px;font-size:20px;
border:none;border-radius:20px;
background:#00ccff;color:#000;font-weight:700;
z-index:1000;cursor:pointer
}

#menuOverlay{
position:fixed;inset:0;background:rgba(0,0,0,.6);
display:none;z-index:2000
}
#menu{
position:fixed;top:0;left:-280px;width:280px;height:100%;
background:#1e1e1e;padding:20px;
transition:.3s;z-index:2001
}
.menu-item{
padding:15px 0;border-bottom:1px solid #333;cursor:pointer
}

#orderBox{
position:absolute;bottom:100px;left:50%;
transform:translateX(-50%);
background:#222;padding:15px 20px;border-radius:15px;
display:none;z-index:1000
}
</style>
</head>

<body>

<div id="map"></div>

<div class="topbar">
<button class="btn" onclick="toggleMenu()"><i class="fa fa-bars"></i></button>
<div class="balance" id="balance">0.00 PLN</div>
<button class="btn" onclick="toggleOnline()"><i class="fa fa-power-off"></i></button>
</div>

<button id="pedal">–í–´–ô–¢–ò –í –û–ù–õ–ê–ô–ù</button>

<div id="orderBox"></div>

<div id="menuOverlay" onclick="toggleMenu()"></div>
<div id="menu">
<div class="menu-item" onclick="alert('–ú–∞–≥–∞–∑–∏–Ω (–∑–∞–≥–ª—É—à–∫–∞)')">üõí –ú–∞–≥–∞–∑–∏–Ω</div>
<div class="menu-item" onclick="alert('–ë–∞–Ω–∫ (–∑–∞–≥–ª—É—à–∫–∞)')">üè¶ –ë–∞–Ω–∫</div>
<div class="menu-item" onclick="alert('–¢–∞–∫—Å–∏ (–ø–æ–∑–∂–µ)')">üöï –¢–∞–∫—Å–∏</div>
<div class="menu-item" onclick="resetGame()">‚ôªÔ∏è –°–±—Ä–æ—Å</div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
/* ================= STATE ================= */
let state={
balance:0,
online:false,
order:null
};

/* ================= MAP ================= */
const map=L.map('map',{zoomControl:false})
.setView([52.2297,21.0122],13);
L.tileLayer(
'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',
{maxZoom:19}
).addTo(map);

/* ================= MENU ================= */
function toggleMenu(){
const o=document.getElementById('menuOverlay');
const m=document.getElementById('menu');
const open=o.style.display==='block';
o.style.display=open?'none':'block';
m.style.left=open?'-280px':'0';
}

/* ================= ONLINE ================= */
const pedal=document.getElementById('pedal');
const orderBox=document.getElementById('orderBox');

pedal.addEventListener('click',pedalPress);
pedal.addEventListener('touchstart',e=>{
e.preventDefault();pedalPress();
},{passive:false});

function toggleOnline(){
state.online=!state.online;
pedal.textContent=state.online?'–ñ–ú–ò –ì–ê–ó':'–í–´–ô–¢–ò –í –û–ù–õ–ê–ô–ù';
if(state.online) findOrder();
else clearOrder();
}

function pedalPress(){
if(!state.online){toggleOnline();return;}
if(!state.order){findOrder();return;}
progressOrder();
}

/* ================= ORDERS ================= */
function findOrder(){
state.order={
progress:0,
pay:(5+Math.random()*10).toFixed(2)
};
orderBox.style.display='block';
orderBox.textContent='üì¶ –ó–∞–∫–∞–∑: '+state.order.pay+' PLN';
pedal.textContent='–í–´–ü–û–õ–ù–Ø–¢–¨';
}

function progressOrder(){
state.order.progress+=25;
orderBox.textContent='üö¥ –í –ø—É—Ç–∏: '+state.order.progress+'%';
if(state.order.progress>=100) completeOrder();
}

function completeOrder(){
state.balance+=parseFloat(state.order.pay);
document.getElementById('balance').textContent=
state.balance.toFixed(2)+' PLN';
clearOrder();
}

function clearOrder(){
state.order=null;
orderBox.style.display='none';
pedal.textContent='–ñ–ú–ò –ì–ê–ó';
}

/* ================= RESET ================= */
function resetGame(){
if(confirm('–°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É?')){
state={balance:0,online:false,order:null};
document.getElementById('balance').textContent='0.00 PLN';
clearOrder();
}
}
</script>

</body>
</html>
