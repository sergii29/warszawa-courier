<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Warsaw Night Courier</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0a0a0a; color: #fff; overflow: hidden; height: 100vh; }
        
        #map { height: 100%; width: 100%; position: absolute; top: 0; left: 0; z-index: 1; }
        .leaflet-tile { filter: brightness(0.4) saturate(0.8) contrast(1.2) !important; }
        
        .ui-layer { position: absolute; z-index: 100; pointer-events: none; width: 100%; height: 100%; }
        .ui-layer > * { pointer-events: auto; }
        
        .top-bar { position: absolute; top: 0; left: 0; right: 0; padding: 15px; background: linear-gradient(to bottom, rgba(0,0,0,0.9), transparent); display: flex; justify-content: space-between; align-items: center; }
        
        .balance-box { background: rgba(0,0,0,0.8); padding: 10px 20px; border-radius: 20px; border: 1px solid #333; }
        .balance-amount { font-size: 20px; font-weight: bold; color: #00e676; }
        .balance-label { font-size: 10px; color: #888; text-transform: uppercase; }
        
        .stats-row { position: absolute; top: 80px; left: 10px; right: 10px; display: flex; gap: 8px; justify-content: center; }
        .stat-pill { background: rgba(0,0,0,0.8); padding: 8px 12px; border-radius: 15px; font-size: 11px; display: flex; align-items: center; gap: 5px; border: 1px solid #333; }
        .stat-pill.energy { border-color: #ffcc00; color: #ffcc00; }
        .stat-pill.water { border-color: #00ccff; color: #00ccff; }
        .stat-pill.mood { border-color: #d500f9; color: #d500f9; }
        
        .bottom-panel { position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(to top, rgba(0,0,0,0.95), transparent); padding: 20px; }
        
        .order-card { background: rgba(20,20,20,0.95); border-radius: 20px; padding: 20px; margin-bottom: 15px; border: 1px solid #333; display: none; }
        .order-card.active { display: block; animation: slideUp 0.3s ease; }
        
        @keyframes slideUp { from { transform: translateY(100px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .restaurant-name { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
        .order-info { color: #888; font-size: 13px; margin-bottom: 15px; }
        .order-price { font-size: 24px; color: #00e676; font-weight: bold; }
        
        .btn { width: 100%; padding: 18px; border: none; border-radius: 15px; font-size: 16px; font-weight: bold; cursor: pointer; transition: all 0.2s; text-transform: uppercase; }
        .btn-primary { background: #00e676; color: #000; }
        .btn-primary:active { transform: scale(0.98); }
        .btn-danger { background: #ff3d00; color: #fff; margin-top: 10px; }
        
        .action-panel { text-align: center; }
        .action-text { color: #888; margin-bottom: 15px; font-size: 14px; }
        
        .toast { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.9); padding: 20px 30px; border-radius: 15px; border: 1px solid #00e676; color: #00e676; font-weight: bold; opacity: 0; pointer-events: none; transition: opacity 0.3s; z-index: 200; }
        .toast.show { opacity: 1; }
        
        .marker-courier { background: #00e676; width: 20px; height: 20px; border-radius: 50%; border: 3px solid #fff; box-shadow: 0 0 20px #00e676; }
        .marker-dest { background: #ff3d00; width: 25px; height: 25px; border-radius: 50%; border: 3px solid #fff; box-shadow: 0 0 20px #ff3d00; animation: pulse 1.5s infinite; }
        
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
    </style>
</head>
<body>
    <div id="map"></div>
    
    <div class="ui-layer">
        <div class="top-bar">
            <div class="balance-box">
                <div class="balance-amount" id="balance">0 PLN</div>
                <div class="balance-label">–ë–∞–ª–∞–Ω—Å</div>
            </div>
        </div>
        
        <div class="stats-row">
            <div class="stat-pill energy">‚ö° <span id="energy-val">100</span>%</div>
            <div class="stat-pill water">üíß <span id="water-val">100</span>%</div>
            <div class="stat-pill mood">üòé <span id="mood-val">100</span>%</div>
        </div>
        
        <div class="bottom-panel">
            <div class="order-card" id="order-panel">
                <div class="restaurant-name" id="rest-name">McDonald's</div>
                <div class="order-info" id="order-dist">2.5 –∫–º ‚Ä¢ 15 –º–∏–Ω</div>
                <div class="order-price" id="order-price">25 PLN</div>
                <button class="btn btn-primary" id="accept-btn" onclick="acceptOrder()">–ü—Ä–∏–Ω—è—Ç—å –∑–∞–∫–∞–∑</button>
                <button class="btn btn-danger" id="deliver-btn" onclick="completeDelivery()" style="display:none">–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ!</button>
            </div>
            
            <div class="action-panel" id="wait-panel">
                <div class="action-text">–°–≤–∞–π–ø–Ω–∏—Ç–µ –∫–∞—Ä—Ç—É –∏–ª–∏ –∂–¥–∏—Ç–µ –∑–∞–∫–∞–∑...</div>
                <button class="btn btn-primary" onclick="findOrder()">üîç –ò—Å–∫–∞—Ç—å –∑–∞–∫–∞–∑</button>
            </div>
        </div>
    </div>
    
    <div class="toast" id="toast">–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç!</div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // –¢–í–û–Ø –ë–ê–ó–ê (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞)
        const firebaseConfig = {
          apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk", 
          authDomain: "warszawa-courier.firebaseapp.com",
          databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app",
          projectId: "warszawa-courier",
          storageBucket: "warszawa-courier.firebasestorage.app",
          messagingSenderId: "295860613508",
          appId: "1:295860613508:web:86fe8364377d6875612dd1",
          measurementId: "G-TGSCHBVLX2"
        };

        // –¶–µ–Ω—Ç—Ä –í–∞—Ä—à–∞–≤—ã
        const WARSAW_CENTER = [52.2297, 21.0122];
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let state = {
            balance: 0,
            energy: 100,
            water: 100,
            mood: 100,
            currentOrder: null,
            isDelivering: false
        };

        // –ö–∞—Ä—Ç–∞
        let map;
        let courierMarker = null;
        let destMarker = null;
        let routeLine = null;

        // –†–µ—Å—Ç–æ—Ä–∞–Ω—ã
        const restaurants = [
            { name: "McDonald's", icon: "üçî" },
            { name: "KFC", icon: "üçó" },
            { name: "Pizza Hut", icon: "üçï" },
            { name: "Sushi Master", icon: "üç£" },
            { name: "Kebab King", icon: "üåØ" }
        ];

        function init() {
            // –¢—ë–º–Ω–∞—è –∫–∞—Ä—Ç–∞ –í–∞—Ä—à–∞–≤—ã
            map = L.map('map', { zoomControl: false, attributionControl: false }).setView(WARSAW_CENTER, 13);
            
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                maxZoom: 19
            }).addTo(map);

            // –ö—É—Ä—å–µ—Ä
            const courierIcon = L.divIcon({
                html: '<div class="marker-courier"></div>',
                className: 'custom-marker',
                iconSize: [20, 20]
            });
            courierMarker = L.marker(WARSAW_CENTER, { icon: courierIcon }).addTo(map);

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            updateUI();
            setInterval(updateStats, 1000);
        }

        function updateUI() {
            document.getElementById('balance').textContent = Math.floor(state.balance) + ' PLN';
            document.getElementById('energy-val').textContent = Math.floor(state.energy);
            document.getElementById('water-val').textContent = Math.floor(state.water);
            document.getElementById('mood-val').textContent = Math.floor(state.mood);
        }

        function updateStats() {
            if (state.isDelivering) {
                state.energy -= 0.5;
                state.water -= 0.3;
                state.mood -= 0.2;
                
                if (state.energy < 0) state.energy = 0;
                if (state.water < 0) state.water = 0;
                if (state.mood < 0) state.mood = 0;
                
                updateUI();
            }
        }

        function findOrder() {
            if (state.isDelivering) return;
            
            const rest = restaurants[Math.floor(Math.random() * restaurants.length)];
            const dist = (1 + Math.random() * 4).toFixed(1);
            const price = Math.floor(15 + Math.random() * 30);
            
            state.currentOrder = {
                restaurant: rest,
                distance: dist,
                price: price,
                destLat: WARSAW_CENTER[0] + (Math.random() - 0.5) * 0.05,
                destLng: WARSAW_CENTER[1] + (Math.random() - 0.5) * 0.08
            };
            
            document.getElementById('rest-name').textContent = rest.name + ' ' + rest.icon;
            document.getElementById('order-dist').textContent = dist + ' –∫–º ‚Ä¢ ~' + Math.floor(dist * 3) + ' –º–∏–Ω';
            document.getElementById('order-price').textContent = price + ' PLN';
            
            document.getElementById('wait-panel').style.display = 'none';
            document.getElementById('order-panel').classList.add('active');
        }

        function acceptOrder() {
            if (!state.currentOrder) return;
            
            state.isDelivering = true;
            



    <script>
        // –¢–í–û–Ø –ë–ê–ó–ê
        const firebaseConfig = {
          apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk", 
          authDomain: "warszawa-courier.firebaseapp.com",
          databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app",
          projectId: "warszawa-courier",
          storageBucket: "warszawa-courier.firebasestorage.app",
          messagingSenderId: "295860613508",
          appId: "1:295860613508:web:86fe8364377d6875612dd1",
          measurementId: "G-TGSCHBVLX2"
        };

        const WARSAW_CENTER = [52.2297, 21.0122];
        
        // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
        const SHOP_ITEMS = {
            water: { name: '–í–æ–¥–∞ 0.5–ª', icon: 'üíß', cost: 3, effect: { water: 40, energy: 5 } },
            coffee: { name: '–ö–æ—Ñ–µ', icon: '‚òï', cost: 6, effect: { energy: 35, mood: 15 } },
            energy: { name: 'Red Bull', icon: '‚ö°', cost: 8, effect: { energy: 60, water: -10 } },
            chocolate: { name: '–°–Ω–∏–∫–µ—Ä—Å', icon: 'üç´', cost: 5, effect: { mood: 30, energy: 10 } }
        };

        let state = {
            balance: 50,
            energy: 100,
            water: 100,
            mood: 100,
            currentOrder: null,
            isDelivering: false,
            inventory: { water: 0, coffee: 0, energy: 0, chocolate: 0 },
            shopOpen: false
        };

        let map, courierMarker, destMarker, routeLine;
        let deliveryInterval = null;

        const restaurants = [
            { name: "McDonald's", icon: "üçî" },
            { name: "KFC", icon: "üçó" },
            { name: "Pizza Hut", icon: "üçï" },
            { name: "Sushi Master", icon: "üç£" },
            { name: "Kebab King", icon: "üåØ" },
            { name: "Burger King", icon: "üçî" }
        ];

        // –°–æ–±—ã—Ç–∏—è –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ
        const ROAD_EVENTS = [
            { name: "üö¶ –°–≤–µ—Ç–æ—Ñ–æ—Ä", delay: 2000, msg: "–ñ–¥—ë–º –∑–µ–ª—ë–Ω—ã–π..." },
            { name: "üöß –†–µ–º–æ–Ω—Ç –¥–æ—Ä–æ–≥–∏", delay: 3000, msg: "–û–±—ä–µ–∑–¥..." },
            { name: "‚òî –î–æ–∂–¥—å", delay: 1500, msg: "–°–∫–æ–ª—å–∑–∫–æ!" },
            { name: "üêï –°–æ–±–∞–∫–∞", delay: 1000, msg: "–û—Å—Ç–æ—Ä–æ–∂–Ω–æ!" }
        ];

        function init() {
            map = L.map('map', { zoomControl: false, attributionControl: false }).setView(WARSAW_CENTER, 13);
            
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                maxZoom: 19
            }).addTo(map);

            const courierIcon = L.divIcon({
                html: '<div class="marker-courier"></div>',
                className: 'custom-marker',
                iconSize: [20, 20]
            });
            courierMarker = L.marker(WARSAW_CENTER, { icon: courierIcon }).addTo(map);

            updateUI();
            setInterval(updateStats, 1000);
        }

        function updateUI() {
            document.getElementById('balance').textContent = Math.floor(state.balance) + ' PLN';
            document.getElementById('energy-val').textContent = Math.floor(state.energy);
            document.getElementById('water-val').textContent = Math.floor(state.water);
            document.getElementById('mood-val').textContent = Math.floor(state.mood);
            
            // –¶–≤–µ—Ç–∞ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
            document.getElementById('energy-val').style.color = state.energy < 30 ? '#ff3d00' : '#ffcc00';
            document.getElementById('water-val').style.color = state.water < 30 ? '#ff3d00' : '#00ccff';
            document.getElementById('mood-val').style.color = state.mood < 30 ? '#ff3d00' : '#d500f9';
        }

        function updateStats() {
            if (state.isDelivering) {
                state.energy -= 0.8;
                state.water -= 0.5;
                state.mood -= 0.3;
                
                if (state.energy < 0) state.energy = 0;
                if (state.water < 0) state.water = 0;
                if (state.mood < 0) state.mood = 0;
                
                // –ï—Å–ª–∏ –≤—Å—ë –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å ‚Äî –ø—Ä–æ–≤–∞–ª
                if (state.energy === 0 || state.water === 0) {
                    failDelivery("–°–∏–ª—ã –∫–æ–Ω—á–∏–ª–∏—Å—å! –ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω—ë–Ω.");
                }
                
                updateUI();
            }
        }

        function findOrder() {
            if (state.isDelivering || state.shopOpen) return;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç–æ–≤
            if (state.energy < 20 || state.water < 20) {
                showToast('‚ö†Ô∏è –ù—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∏–ª—ã! –û—Ç–∫—Ä–æ–π—Ç–µ –º–∞–≥–∞–∑–∏–Ω.');
                return;
            }
            
            const rest = restaurants[Math.floor(Math.random() * restaurants.length)];
            const dist = (1 + Math.random() * 4).toFixed(1);
            const basePrice = Math.floor(15 + Math.random() * 25);
            const bonus = state.mood > 80 ? 10 : 0;
            const price = basePrice + bonus;
            
            state.currentOrder = {
                restaurant: rest,
                distance: dist,
                price: price,
                destLat: WARSAW_CENTER[0] + (Math.random() - 0.5) * 0.05,
                destLng: WARSAW_CENTER[1] + (Math.random() - 0.5) * 0.08
            };
            
            document.getElementById('rest-name').textContent = rest.name + ' ' + rest.icon;
            document.getElementById('order-dist').textContent = dist + ' –∫–º ‚Ä¢ ~' + Math.floor(dist * 4) + ' –º–∏–Ω';
            document.getElementById('order-price').textContent = price + ' PLN' + (bonus > 0 ? ' (+–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ!)' : '');
            
            document.getElementById('wait-panel').style.display = 'none';
            document.getElementById('shop-panel').style.display = 'none';
            document.getElementById('order-panel').classList.add('active');
        }

        function acceptOrder() {
            if (!state.currentOrder) return;
            
            state.isDelivering = true;
            
            const dest = [state.currentOrder.destLat, state.currentOrder.destLng];
            
            const destIcon = L.divIcon({
                html: '<div class="marker-dest"></div>',
                className: 'custom-marker',
                iconSize: [25, 25]
            });
            destMarker = L.marker(dest, { icon: destIcon }).addTo(map);
            
            routeLine = L.polyline([WARSAW_CENTER, dest], {
                color: '#00e676',
                weight: 4,
                opacity: 0.8,
                dashArray: '10, 10'
            }).addTo(map);
            
            map.fitBounds([WARSAW_CENTER, dest], { padding: [50, 50] });
            
            document.getElementById('accept-btn').style.display = 'none';
            document.getElementById('deliver-btn').style.display = 'none';
            document.getElementById('order-dist').textContent = '–í –ø—É—Ç–∏... –ù–∞–∂–∏–º–∞–π—Ç–µ "–ï—Ö–∞—Ç—å!"';
            
            // –ö–Ω–æ–ø–∫–∞ –µ–∑–¥—ã
            const driveBtn = document.createElement('button');
            driveBtn.className = 'btn btn-primary';
            driveBtn.id = 'drive-btn';
            driveBtn.textContent = 'üö≤ –ï—Ö–∞—Ç—å!';
            driveBtn.onclick = drive;
            document.getElementById('order-panel').appendChild(driveBtn);
            
            showToast('–ü–æ–µ—Ö–∞–ª–∏! –ñ–º–∏—Ç–µ "–ï—Ö–∞—Ç—å!" —á—Ç–æ–±—ã –¥–≤–∏–≥–∞—Ç—å—Å—è.');
        }

        let driveProgress = 0;
        let eventTriggered = false;

        function drive() {
            if (!state.isDelivering) return;
            
            // –†–∞—Å—Ö–æ–¥ —Ä–µ—Å—É—Ä—Å–æ–≤ –∑–∞ –∫–∞–∂–¥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ
            state.energy -= 3;
            state.water -= 2;
            state.mood -= 1;
            updateUI();
            
            driveProgress += 8;
            
            // –°–ª—É—á–∞–π–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –Ω–∞ —Å–µ—Ä–µ–¥–∏–Ω–µ
            if (driveProgress > 50 && !eventTriggered && Math.random() > 0.5) {
                eventTriggered = true;
                const event = ROAD_EVENTS[Math.floor(Math.random() * ROAD_EVENTS.length)];
                showToast(event.msg);
                document.getElementById('order-dist').textContent = event.name + '...';
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞ –≤—Ä–µ–º—è
                const btn = document.getElementById('drive-btn');
                btn.disabled = true;
                setTimeout(() => {
                    btn.disabled = false;
                    document.getElementById('order-dist').textContent = '–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—É—Ç—å...';
                }, event.delay);
            }
            
            // –î–≤–∏–≥–∞–µ–º –∫—É—Ä—å–µ—Ä–∞
            const start = WARSAW_CENTER;
            const end = [state.currentOrder.destLat, state.currentOrder.destLng];
            const lat = start[0] + (end[0] - start[0]) * (driveProgress / 100);
            const lng = start[1] + (end[1] - start[1]) * (driveProgress / 100);
            courierMarker.setLatLng([lat, lng]);
            
            if (driveProgress >= 100) {
                document.getElementById('drive-btn').remove();
                document.getElementById('deliver-btn').style.display = 'block';
                document.getElementById('order-dist').textContent = '–ü—Ä–∏–±—ã–ª–∏! –ö–ª–∏–µ–Ω—Ç –∂–¥—ë—Ç.';
                showToast('–ù–∞ –º–µ—Å—Ç–µ! –ñ–º–∏—Ç–µ "–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ"');
            }
        }

        function completeDelivery() {
            if (!state.isDelivering) return;
            
            let earned = state.currentOrder.price;
            
            // –ë–æ–Ω—É—Å—ã –∏ —à—Ç—Ä–∞—Ñ—ã
            if (state.mood > 80) earned += Math.floor(earned * 0.2);
            if (state.energy < 30) earned -= 5;
            if (state.mood < 30) earned -= 3;
            
            state.balance += earned;
            
            // –°–±—Ä–æ—Å
            state.isDelivering = false;
            state.currentOrder = null;
            driveProgress = 0;
            eventTriggered = false;
            
            if (destMarker) map.removeLayer(destMarker);
            if (routeLine) map.removeLayer(routeLine);
            courierMarker.setLatLng(WARSAW_CENTER);
            map.setView(WARSAW_CENTER, 13);
            
            document.getElementById('order-panel').classList.remove('active');
            document.getElementById('wait-panel').style.display = 'block';
            document.getElementById('accept-btn').style.display = 'block';
            document.getElementById('deliver-btn').style.display = 'none';
            
            showToast('+' + earned + ' PLN! üí∞');
            updateUI();
        }

        function failDelivery(reason) {
            state.isDelivering = false;
            state.currentOrder = null;
            driveProgress = 0;
            
            if (destMarker) map.removeLayer(destMarker);
            if (routeLine) map.removeLayer(routeLine);
            courierMarker.setLatLng(WARSAW_CENTER);
            
            const driveBtn = document.getElementById('drive-btn');
            if (driveBtn) driveBtn.remove();
            
            document.getElementById('order-panel').classList.remove('active');
            document.getElementById('wait-panel').style.display = 'block';
            document.getElementById('accept-btn').style.display = 'block';
            
            showToast(reason);
            updateUI();
        }

        // –ú–ê–ì–ê–ó–ò–ù
        function toggleShop() {
            state.shopOpen = !state.shopOpen;
            const shopPanel = document.getElementById('shop-panel');
            const waitPanel = document.getElementById('wait-panel');
            
            if (state.shopOpen) {
                renderShop();
                shopPanel.style.display = 'block';
                waitPanel.style.display = 'none';
            } else {
                shopPanel.style.display = 'none';
                waitPanel.style.display = 'block';
            }
        }

        function renderShop() {
            const shopItems = document.getElementById('shop-items');
            shopItems.innerHTML = '';
            
            for (let [key, item] of Object.entries(SHOP_ITEMS)) {
                const div = document.createElement('div');
                div.style.cssText = 'background:#1a1a1a; padding:15px; border-radius:10px; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center; border:1px solid #333;';
                div.innerHTML = `
                    <div>
                        <div style="font-size:18px; margin-bottom:5px;">${item.icon} ${item.name}</div>
                        <div style="font-size:11px; color:#888;">${getEffectText(item.effect)}</div>
                    </div>
                    <button class="btn btn-primary" style="width:auto; padding:10px 20px;" onclick="buyItem('${key}')">
                        ${item.cost} PLN
                    </button>
                `;
                shopItems.appendChild(div);
            }
        }

        function getEffectText(effect) {
            let text = [];
            if (effect.energy) text.push(`‚ö°${effect.energy > 0 ? '+' : ''}${effect.energy}`);
            if (effect.water) text.push(`üíß${effect.water > 0 ? '+' : ''}${effect.water}`);
            if (effect.mood) text.push(`üòé${effect.mood > 0 ? '+' : ''}${effect.mood}`);
            return text.join(' ‚Ä¢ ');
        }

        function buyItem(key) {
            const item = SHOP_ITEMS[key];
            if (state.balance < item.cost) {
                showToast('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!');
                return;
            }
            
            state.balance -= item.cost;
            state.energy = Math.min(100, state.energy + (item.effect.energy || 0));
            state.water = Math.min(100, state.water + (item.effect.water || 0));
            state.mood = Math.min(100, state.mood + (item.effect.mood || 0));
            
            showToast(`${item.icon} –ö—É–ø–ª–µ–Ω–æ!`);
            updateUI();
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.textContent = msg;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2500);
        }

        init();
    </script>
</body>
</html>


        



    <script>
        // –¢–í–û–Ø –ë–ê–ó–ê
        const firebaseConfig = {
          apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk", 
          authDomain: "warszawa-courier.firebaseapp.com",
          databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app",
          projectId: "warszawa-courier",
          storageBucket: "warszawa-courier.firebasestorage.app",
          messagingSenderId: "295860613508",
          appId: "1:295860613508:web:86fe8364377d6875612dd1",
          measurementId: "G-TGSCHBVLX2"
        };

        const WARSAW_CENTER = [52.2297, 21.0122];
        
        // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
        const SHOP_ITEMS = {
            water: { name: '–í–æ–¥–∞ 0.5–ª', icon: 'üíß', cost: 3, effect: { water: 40, energy: 5 } },
            coffee: { name: '–ö–æ—Ñ–µ', icon: '‚òï', cost: 6, effect: { energy: 35, mood: 15 } },
            energy: { name: 'Red Bull', icon: '‚ö°', cost: 8, effect: { energy: 60, water: -10 } },
            chocolate: { name: '–°–Ω–∏–∫–µ—Ä—Å', icon: 'üç´', cost: 5, effect: { mood: 30, energy: 10 } }
        };

        let state = {
            balance: 50,
            energy: 100,
            water: 100,
            mood: 100,
            currentOrder: null,
            isDelivering: false,
            inventory: { water: 0, coffee: 0, energy: 0, chocolate: 0 },
            shopOpen: false
        };

        let map, courierMarker, destMarker, routeLine;
        let deliveryInterval = null;

        const restaurants = [
            { name: "McDonald's", icon: "üçî" },
            { name: "KFC", icon: "üçó" },
            { name: "Pizza Hut", icon: "üçï" },
            { name: "Sushi Master", icon: "üç£" },
            { name: "Kebab King", icon: "üåØ" },
            { name: "Burger King", icon: "üçî" }
        ];

        // –°–æ–±—ã—Ç–∏—è –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ
        const ROAD_EVENTS = [
            { name: "üö¶ –°–≤–µ—Ç–æ—Ñ–æ—Ä", delay: 2000, msg: "–ñ–¥—ë–º –∑–µ–ª—ë–Ω—ã–π..." },
            { name: "üöß –†–µ–º–æ–Ω—Ç –¥–æ—Ä–æ–≥–∏", delay: 3000, msg: "–û–±—ä–µ–∑–¥..." },
            { name: "‚òî –î–æ–∂–¥—å", delay: 1500, msg: "–°–∫–æ–ª—å–∑–∫–æ!" },
            { name: "üêï –°–æ–±–∞–∫–∞", delay: 1000, msg: "–û—Å—Ç–æ—Ä–æ–∂–Ω–æ!" }
        ];

        function init() {
            map = L.map('map', { zoomControl: false, attributionControl: false }).setView(WARSAW_CENTER, 13);
            
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                maxZoom: 19
            }).addTo(map);

            const courierIcon = L.divIcon({
                html: '<div class="marker-courier"></div>',
                className: 'custom-marker',
                iconSize: [20, 20]
            });
            courierMarker = L.marker(WARSAW_CENTER, { icon: courierIcon }).addTo(map);

            updateUI();
            setInterval(updateStats, 1000);
        }

        function updateUI() {
            document.getElementById('balance').textContent = Math.floor(state.balance) + ' PLN';
            document.getElementById('energy-val').textContent = Math.floor(state.energy);
            document.getElementById('water-val').textContent = Math.floor(state.water);
            document.getElementById('mood-val').textContent = Math.floor(state.mood);
            
            // –¶–≤–µ—Ç–∞ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
            document.getElementById('energy-val').style.color = state.energy < 30 ? '#ff3d00' : '#ffcc00';
            document.getElementById('water-val').style.color = state.water < 30 ? '#ff3d00' : '#00ccff';
            document.getElementById('mood-val').style.color = state.mood < 30 ? '#ff3d00' : '#d500f9';
        }

        function updateStats() {
            if (state.isDelivering) {
                state.energy -= 0.8;
                state.water -= 0.5;
                state.mood -= 0.3;
                
                if (state.energy < 0) state.energy = 0;
                if (state.water < 0) state.water = 0;
                if (state.mood < 0) state.mood = 0;
                
                // –ï—Å–ª–∏ –≤—Å—ë –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å ‚Äî –ø—Ä–æ–≤–∞–ª
                if (state.energy === 0 || state.water === 0) {
                    failDelivery("–°–∏–ª—ã –∫–æ–Ω—á–∏–ª–∏—Å—å! –ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω—ë–Ω.");
                }
                
                updateUI();
            }
        }

        function findOrder() {
            if (state.isDelivering || state.shopOpen) return;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç–æ–≤
            if (state.energy < 20 || state.water < 20) {
                showToast('‚ö†Ô∏è –ù—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∏–ª—ã! –û—Ç–∫—Ä–æ–π—Ç–µ –º–∞–≥–∞–∑–∏–Ω.');
                return;
            }
            
            const rest = restaurants[Math.floor(Math.random() * restaurants.length)];
            const dist = (1 + Math.random() * 4).toFixed(1);
            const basePrice = Math.floor(15 + Math.random() * 25);
            const bonus = state.mood > 80 ? 10 : 0;
            const price = basePrice + bonus;
            
            state.currentOrder = {
                restaurant: rest,
                distance: dist,
                price: price,
                destLat: WARSAW_CENTER[0] + (Math.random() - 0.5) * 0.05,
                destLng: WARSAW_CENTER[1] + (Math.random() - 0.5) * 0.08
            };
            
            document.getElementById('rest-name').textContent = rest.name + ' ' + rest.icon;
            document.getElementById('order-dist').textContent = dist + ' –∫–º ‚Ä¢ ~' + Math.floor(dist * 4) + ' –º–∏–Ω';
            document.getElementById('order-price').textContent = price + ' PLN' + (bonus > 0 ? ' (+–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ!)' : '');
            
            document.getElementById('wait-panel').style.display = 'none';
            document.getElementById('shop-panel').style.display = 'none';
            document.getElementById('order-panel').classList.add('active');
        }

        function acceptOrder() {
            if (!state.currentOrder) return;
            
            state.isDelivering = true;
            
            const dest = [state.currentOrder.destLat, state.currentOrder.destLng];
            
            const destIcon = L.divIcon({
                html: '<div class="marker-dest"></div>',
                className: 'custom-marker',
                iconSize: [25, 25]
            });
            destMarker = L.marker(dest, { icon: destIcon }).addTo(map);
            
            routeLine = L.polyline([WARSAW_CENTER, dest], {
                color: '#00e676',
                weight: 4,
                opacity: 0.8,
                dashArray: '10, 10'
            }).addTo(map);
            
            map.fitBounds([WARSAW_CENTER, dest], { padding: [50, 50] });
            
            document.getElementById('accept-btn').style.display = 'none';
            document.getElementById('deliver-btn').style.display = 'none';
            document.getElementById('order-dist').textContent = '–í –ø—É—Ç–∏... –ù–∞–∂–∏–º–∞–π—Ç–µ "–ï—Ö–∞—Ç—å!"';
            
            // –ö–Ω–æ–ø–∫–∞ –µ–∑–¥—ã
            const driveBtn = document.createElement('button');
            driveBtn.className = 'btn btn-primary';
            driveBtn.id = 'drive-btn';
            driveBtn.textContent = 'üö≤ –ï—Ö–∞—Ç—å!';
            driveBtn.onclick = drive;
            document.getElementById('order-panel').appendChild(driveBtn);
            
            showToast('–ü–æ–µ—Ö–∞–ª–∏! –ñ–º–∏—Ç–µ "–ï—Ö–∞—Ç—å!" —á—Ç–æ–±—ã –¥–≤–∏–≥–∞—Ç—å—Å—è.');
        }

        let driveProgress = 0;
        let eventTriggered = false;

        function drive() {
            if (!state.isDelivering) return;
            
            // –†–∞—Å—Ö–æ–¥ —Ä–µ—Å—É—Ä—Å–æ–≤ –∑–∞ –∫–∞–∂–¥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ
            state.energy -= 3;
            state.water -= 2;
            state.mood -= 1;
            updateUI();
            
            driveProgress += 8;
            
            // –°–ª—É—á–∞–π–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –Ω–∞ —Å–µ—Ä–µ–¥–∏–Ω–µ
            if (driveProgress > 50 && !eventTriggered && Math.random() > 0.5) {
                eventTriggered = true;
                const event = ROAD_EVENTS[Math.floor(Math.random() * ROAD_EVENTS.length)];
                showToast(event.msg);
                document.getElementById('order-dist').textContent = event.name + '...';
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞ –≤—Ä–µ–º—è
                const btn = document.getElementById('drive-btn');
                btn.disabled = true;
                setTimeout(() => {
                    btn.disabled = false;
                    document.getElementById('order-dist').textContent = '–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—É—Ç—å...';
                }, event.delay);
            }
            
            // –î–≤–∏–≥–∞–µ–º –∫—É—Ä—å–µ—Ä–∞
            const start = WARSAW_CENTER;
            const end = [state.currentOrder.destLat, state.currentOrder.destLng];
            const lat = start[0] + (end[0] - start[0]) * (driveProgress / 100);
            const lng = start[1] + (end[1] - start[1]) * (driveProgress / 100);
            courierMarker.setLatLng([lat, lng]);
            
            if (driveProgress >= 100) {
                document.getElementById('drive-btn').remove();
                document.getElementById('deliver-btn').style.display = 'block';
                document.getElementById('order-dist').textContent = '–ü—Ä–∏–±—ã–ª–∏! –ö–ª–∏–µ–Ω—Ç –∂–¥—ë—Ç.';
                showToast('–ù–∞ –º–µ—Å—Ç–µ! –ñ–º–∏—Ç–µ "–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ"');
            }
        }

        function completeDelivery() {
            if (!state.isDelivering) return;
            
            let earned = state.currentOrder.price;
            
            // –ë–æ–Ω—É—Å—ã –∏ —à—Ç—Ä–∞—Ñ—ã
            if (state.mood > 80) earned += Math.floor(earned * 0.2);
            if (state.energy < 30) earned -= 5;
            if (state.mood < 30) earned -= 3;
            
            state.balance += earned;
            
            // –°–±—Ä–æ—Å
            state.isDelivering = false;
            state.currentOrder = null;
            driveProgress = 0;
            eventTriggered = false;
            
            if (destMarker) map.removeLayer(destMarker);
            if (routeLine) map.removeLayer(routeLine);
            courierMarker.setLatLng(WARSAW_CENTER);
            map.setView(WARSAW_CENTER, 13);
            
            document.getElementById('order-panel').classList.remove('active');
            document.getElementById('wait-panel').style.display = 'block';
            document.getElementById('accept-btn').style.display = 'block';
            document.getElementById('deliver-btn').style.display = 'none';
            
            showToast('+' + earned + ' PLN! üí∞');
            updateUI();
        }

        function failDelivery(reason) {
            state.isDelivering = false;
            state.currentOrder = null;
            driveProgress = 0;
            
            if (destMarker) map.removeLayer(destMarker);
            if (routeLine) map.removeLayer(routeLine);
            courierMarker.setLatLng(WARSAW_CENTER);
            
            const driveBtn = document.getElementById('drive-btn');
            if (driveBtn) driveBtn.remove();
            
            document.getElementById('order-panel').classList.remove('active');
            document.getElementById('wait-panel').style.display = 'block';
            document.getElementById('accept-btn').style.display = 'block';
            
            showToast(reason);
            updateUI();
        }

        // –ú–ê–ì–ê–ó–ò–ù
        function toggleShop() {
            state.shopOpen = !state.shopOpen;
            const shopPanel = document.getElementById('shop-panel');
            const waitPanel = document.getElementById('wait-panel');
            
            if (state.shopOpen) {
                renderShop();
                shopPanel.style.display = 'block';
                waitPanel.style.display = 'none';
            } else {
                shopPanel.style.display = 'none';
                waitPanel.style.display = 'block';
            }
        }

        function renderShop() {
            const shopItems = document.getElementById('shop-items');
            shopItems.innerHTML = '';
            
            for (let [key, item] of Object.entries(SHOP_ITEMS)) {
                const div = document.createElement('div');
                div.style.cssText = 'background:#1a1a1a; padding:15px; border-radius:10px; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center; border:1px solid #333;';
                div.innerHTML = `
                    <div>
                        <div style="font-size:18px; margin-bottom:5px;">${item.icon} ${item.name}</div>
                        <div style="font-size:11px; color:#888;">${getEffectText(item.effect)}</div>
                    </div>
                    <button class="btn btn-primary" style="width:auto; padding:10px 20px;" onclick="buyItem('${key}')">
                        ${item.cost} PLN
                    </button>
                `;
                shopItems.appendChild(div);
            }
        }

        function getEffectText(effect) {
            let text = [];
            if (effect.energy) text.push(`‚ö°${effect.energy > 0 ? '+' : ''}${effect.energy}`);
            if (effect.water) text.push(`üíß${effect.water > 0 ? '+' : ''}${effect.water}`);
            if (effect.mood) text.push(`üòé${effect.mood > 0 ? '+' : ''}${effect.mood}`);
            return text.join(' ‚Ä¢ ');
        }

        function buyItem(key) {
            const item = SHOP_ITEMS[key];
            if (state.balance < item.cost) {
                showToast('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!');
                return;
            }
            
            state.balance -= item.cost;
            state.energy = Math.min(100, state.energy + (item.effect.energy || 0));
            state.water = Math.min(100, state.water + (item.effect.water || 0));
            state.mood = Math.min(100, state.mood + (item.effect.mood || 0));
            
            showToast(`${item.icon} –ö—É–ø–ª–µ–Ω–æ!`);
            updateUI();
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.textContent = msg;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2500);
        }

        init();
    </script>
</body>
</html>
