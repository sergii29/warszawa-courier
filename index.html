<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Warsaw Night Courier</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        /* –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò –ò–ó –û–†–ò–ì–ò–ù–ê–õ–ê */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0a0a0a; color: #fff; overflow: hidden; height: 100vh; }
        #map { height: 100%; width: 100%; position: absolute; top: 0; left: 0; z-index: 1; }
        .leaflet-tile { filter: brightness(0.3) saturate(0.6) contrast(1.3) !important; }
        .ui-layer { position: absolute; z-index: 100; pointer-events: none; width: 100%; height: 100%; }
        .ui-layer > * { pointer-events: auto; }
        
        .top-panel { position: absolute; top: 0; left: 0; right: 0; padding: 10px; background: linear-gradient(to bottom, rgba(0,0,0,0.95), transparent); z-index: 1000; }
        .balance-box { background: rgba(0,0,0,0.8); padding: 6px 15px; border-radius: 15px; border: 1px solid #00e676; display: inline-block; margin-bottom: 8px; }
        .balance-amount { font-size: 18px; font-weight: bold; color: #00e676; }
        .stats-grid { display: flex; gap: 8px; justify-content: center; }
        .stat-card { background: rgba(20,20,20,0.9); padding: 8px 12px; border-radius: 12px; text-align: center; min-width: 70px; border: 2px solid; }
        .stat-card.energy { border-color: #ffcc00; }
        .stat-card.water { border-color: #00ccff; }
        .stat-card.mood { border-color: #d500f9; }
        .stat-bar { width: 100%; height: 3px; background: #333; border-radius: 2px; margin-top: 4px; overflow: hidden; }
        .stat-fill { height: 100%; transition: width 0.3s; }
        .energy .stat-fill { background: #ffcc00; }
        .water .stat-fill { background: #00ccff; }
        .mood .stat-fill { background: #d500f9; }

        /* –ù–û–í–û–ï –£–ú–ù–û–ï –ú–ï–ù–Æ */
        .neo-nav {
            position: fixed !important;
            top: 135px; /* –ü–æ–¥ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ —Å—Ç–∞—Ç–æ–≤ */
            left: 50%;
            transform: translateX(-50%);
            width: 95%;
            max-width: 450px;
            background: rgba(15, 15, 15, 0.95);
            border: 1px solid #00e676;
            border-radius: 14px;
            display: flex;
            padding: 4px;
            z-index: 5000;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }

        /* –°—Ç–∏–ª—å –∫–Ω–æ–ø–æ–∫ –≤ –º–µ–Ω—é */
        .nav-btn {
            flex: 1;
            background: transparent;
            border: none;
            color: white;
            padding: 8px 2px;
            font-size: 10px;
            font-weight: bold;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
            cursor: pointer;
            border-radius: 10px;
        }
        .nav-btn:active { background: rgba(255,255,255,0.1); }
        .nav-btn i { font-style: normal; font-size: 18px; }
        .nav-btn span { opacity: 0.8; font-size: 9px; }

        /* –ö–æ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç–æ –æ–∫–Ω–æ - –º–µ–Ω—é –ø—Ä—ã–≥–∞–µ—Ç –≤ —à–∞–ø–∫—É */
        .neo-nav.in-modal {
            top: 0 !important;
            width: 100% !important;
            max-width: none !important;
            border-radius: 0 !important;
            border-top: none;
            background: #111 !important;
        }

        /* –°–¥–≤–∏–≥–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –æ–∫–Ω–∞, —á—Ç–æ–±—ã –∫–Ω–æ–ø–∫–∏ –µ–≥–æ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–ª–∏ */
        .quick-rest-panel {
            position: fixed;
            top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
            background: #151515; padding: 20px; border-radius: 25px;
            border: 2px solid #00e676; z-index: 4000; width: 90%; max-width: 350px;
            transition: transform 0.3s;
        }
        .quick-rest-panel.active { transform: translate(-50%, -50%) scale(1); padding-top: 70px !important; }
        
        .overlay-backdrop { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 3900; display: none; }
        .overlay-backdrop.active { display: block; }
        
        .rest-option { background: #222; padding: 12px; border-radius: 12px; margin-bottom: 8px; border: 1px solid #333; cursor: pointer; }
        .btn-close { width: 100%; padding: 10px; background: #333; color: #888; border: none; border-radius: 10px; margin-top: 10px; }
        
        /* –ö–Ω–æ–ø–∫–∞ "–í –ü–£–¢–¨" */
        .delivery-action-panel { position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%); z-index: 2000; display: none; }
        .delivery-action-panel.active { display: block; }
        .btn-go { background: #00e676; color: black; padding: 15px 40px; border-radius: 30px; font-weight: bold; border: none; font-size: 18px; box-shadow: 0 0 20px #00e676; }
    </style>
</head>
<body>
    <div id="map"></div>
    
    <div class="top-panel">
        <div class="balance-box"><div class="balance-amount" id="balance">50 ‚ÇΩ</div></div>
        <div class="stats-grid">
            <div class="stat-card energy" id="energy-card"><i>‚ö°</i><div class="stat-value" id="energy-val">100</div><div class="stat-bar"><div class="stat-fill" id="energy-bar" style="width:100%"></div></div></div>
            <div class="stat-card water" id="water-card"><i>üíß</i><div class="stat-value" id="water-val">100</div><div class="stat-bar"><div class="stat-fill" id="water-bar" style="width:100%"></div></div></div>
            <div class="stat-card mood" id="mood-card"><i>üòé</i><div class="stat-value" id="mood-val">100</div><div class="stat-bar"><div class="stat-fill" id="mood-bar" style="width:100%"></div></div></div>
        </div>
    </div>

    <div class="neo-nav" id="main-nav">
        <button class="nav-btn" onclick="openFast('water')"><i>üíß</i>–í–æ–¥–∞<span>3 ‚ÇΩ</span></button>
        <button class="nav-btn" onclick="openFast('energy')"><i>‚òï</i>–ö–æ—Ñ–µ<span>5 ‚ÇΩ</span></button>
        <button class="nav-btn" onclick="findOrder()"><i>üì¶</i>–ó–ê–ö–ê–ó</button>
        <button class="nav-btn" onclick="openShop()"><i>üõí</i>–ú–ê–†–ö–ï–¢</button>
    </div>

    <div class="delivery-action-panel" id="go-panel">
        <button class="btn-go" onclick="startDrive()">–í –ü–£–¢–¨! üö≤</button>
    </div>

    <div class="overlay-backdrop" id="backdrop" onclick="closeAll()"></div>
    <div class="quick-rest-panel" id="modal">
        <div id="modal-content"></div>
        <button class="btn-close" onclick="closeAll()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // –î–ê–ù–ù–´–ï –ò –°–û–°–¢–û–Ø–ù–ò–ï
        let state = { balance: 50, energy: 100, water: 100, mood: 100 };
        const ITEMS = {
            water: [{ n: '–í–æ–¥–∞ 0.5', cost: 3, w: 40, e: 0 }, { n: '–ò–∑–æ—Ç–æ–Ω–∏–∫', cost: 7, w: 70, e: 10 }],
            energy: [{ n: '–≠—Å–ø—Ä–µ—Å—Å–æ', cost: 5, e: 35, w: -5 }, { n: 'Red Bull', cost: 10, e: 70, w: -10 }]
        };

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ö–ê–†–¢–´
        const map = L.map('map', { zoomControl: false }).setView([52.2297, 21.0122], 14);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);
        L.marker([52.2297, 21.0122]).addTo(map);

        // –§–£–ù–ö–¶–ò–ò –ò–ù–¢–ï–†–§–ï–ô–°–ê
        function updateUI() {
            document.getElementById('balance').textContent = state.balance + ' ‚ÇΩ';
            document.getElementById('energy-val').textContent = Math.round(state.energy);
            document.getElementById('energy-bar').style.width = state.energy + '%';
            document.getElementById('water-val').textContent = Math.round(state.water);
            document.getElementById('water-bar').style.width = state.water + '%';
            document.getElementById('mood-val').textContent = Math.round(state.mood);
            document.getElementById('mood-bar').style.width = state.mood + '%';
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –¥–ª—è —Å–º–µ—â–µ–Ω–∏—è –º–µ–Ω—é
            const nav = document.getElementById('main-nav');
            const isModal = document.getElementById('modal').classList.contains('active');
            nav.classList.toggle('in-modal', isModal);
        }

        function openFast(type) {
            let html = `<h3>${type === 'water' ? '–ù–∞–ø–∏—Ç–∫–∏' : '–ë–æ–¥—Ä–æ—Å—Ç—å'}</h3><br>`;
            ITEMS[type].forEach(i => {
                html += `<div class="rest-option" onclick="buyItem(${i.cost}, ${i.e||0}, ${i.w||0})">
                    <b>${i.n}</b> ‚Äî ${i.cost} ‚ÇΩ<br>
                    <small>‚ö°${i.e||0} üíß${i.w||0}</small>
                </div>`;
            });
            document.getElementById('modal-content').innerHTML = html;
            document.getElementById('modal').classList.add('active');
            document.getElementById('backdrop').classList.add('active');
            updateUI();
        }

        function buyItem(cost, e, w) {
            if (state.balance >= cost) {
                state.balance -= cost;
                state.energy = Math.min(100, state.energy + e);
                state.water = Math.min(100, state.water + w);
                updateUI();
                closeAll();
            } else { alert("–ú–∞–ª–æ –¥–µ–Ω–µ–≥!"); }
        }

        function findOrder() {
            document.getElementById('modal-content').innerHTML = `
                <h3>–ù–æ–≤—ã–π –∑–∞–∫–∞–∑</h3><br>
                <div class="rest-option" onclick="acceptOrder()">
                    <b>–ë—É—Ä–≥–µ—Ä—ã –≤ –¶–µ–Ω—Ç—Ä</b><br>
                    –ù–∞–≥—Ä–∞–¥–∞: 45 ‚ÇΩ <br>–î–∏—Å—Ç–∞–Ω—Ü–∏—è: 2.4 –∫–º
                </div>
            `;
            document.getElementById('modal').classList.add('active');
            document.getElementById('backdrop').classList.add('active');
            updateUI();
        }

        function acceptOrder() {
            closeAll();
            document.getElementById('go-panel').classList.add('active');
        }

        function closeAll() {
            document.getElementById('modal').classList.remove('active');
            document.getElementById('backdrop').classList.remove('active');
            updateUI();
        }

        function startDrive() { alert("–ü–æ–µ—Ö–∞–ª–∏! (–¢—É—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –º–∏–Ω–∏-–∏–≥—Ä–∞)"); }

        // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∞–ª—é—Ç—É –≤–µ–∑–¥–µ
        setInterval(() => {
            const nodes = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT);
            let n; while(n = nodes.nextNode()) {
                if(n.textContent.includes('PLN')) n.textContent = n.textContent.replace(/PLN/g, '‚ÇΩ');
            }
        }, 500);

        updateUI();
    </script>
</body>
</html>
