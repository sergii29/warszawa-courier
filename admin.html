<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Warszawa GOD MODE ‚ö°</title>
    <style>
        :root { 
            --bg: #000000; --card-bg: #1c1c1e; --accent: #0a84ff; --green: #30d158; 
            --danger: #ff453a; --text: #ffffff; --subtext: #8e8e93; --gold: #ffd60a; --border: #38383a;
        }
        body { background: var(--bg); color: var(--text); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 15px; padding-bottom: 50px; }
        h2 { margin: 0 0 15px 0; font-size: 22px; letter-spacing: -0.5px; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .stat-card { background: var(--card-bg); padding: 12px; border-radius: 12px; text-align: center; border: 1px solid var(--border); }
        .stat-val { font-size: 20px; font-weight: 800; display: block; margin-bottom: 4px; }
        .stat-label { color: var(--subtext); font-size: 10px; text-transform: uppercase; font-weight: 600; }
        .online-dot { width: 8px; height: 8px; background: var(--green); border-radius: 50%; display: inline-block; box-shadow: 0 0 8px var(--green); }
        .users-list { display: flex; flex-direction: column; gap: 12px; }
        .user-card { background: var(--card-bg); border-radius: 16px; padding: 16px; border: 1px solid var(--border); display: flex; flex-direction: column; gap: 12px; position: relative; }
        .user-header { display: flex; align-items: center; justify-content: space-between; }
        .user-info { display: flex; align-items: center; gap: 12px; }
        .user-avatar { width: 42px; height: 42px; background: #2c2c2e; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; }
        .user-names h4 { margin: 0; font-size: 16px; font-weight: 600; }
        .user-names div { color: var(--subtext); font-size: 12px; margin-top: 2px; }
        .user-stats { display: flex; gap: 10px; background: rgba(255,255,255,0.03); padding: 10px; border-radius: 10px; }
        .stat-box { flex: 1; text-align: center; }
        .stat-box small { display: block; color: var(--subtext); font-size: 10px; }
        .stat-box b { font-size: 14px; }
        .user-inventory { display: flex; gap: 5px; flex-wrap: wrap; justify-content: flex-start; min-height: 20px;}
        .inv-icon { font-size: 14px; background: #2c2c2e; padding: 4px; border-radius: 6px; }
        .btn-manage { background: var(--accent); color: white; border: none; padding: 12px; border-radius: 10px; font-weight: 600; font-size: 14px; width: 100%; margin-top: 5px; cursor: pointer; }
        .badge { padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: bold; }
        .badge-on { background: rgba(48, 209, 88, 0.15); color: var(--green); }
        .badge-off { background: rgba(142, 142, 147, 0.15); color: var(--subtext); }
        #editor-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(3px); z-index: 1000; align-items: flex-end; justify-content: center; opacity: 0; transition: opacity 0.3s; }
        #editor-modal.show { opacity: 1; }
        .editor-content { background: #1c1c1e; width: 100%; max-width: 600px; max-height: 85vh; overflow-y: auto; border-radius: 20px 20px 0 0; border-top: 1px solid var(--border); padding: 20px; padding-bottom: 40px; box-shadow: 0 -10px 40px rgba(0,0,0,0.5); animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .form-input { background: #2c2c2e; border: 1px solid #3a3a3c; color: white; padding: 12px; border-radius: 10px; width: 100%; font-size: 16px; box-sizing: border-box; margin-bottom: 15px;}
        .btn-action-modal { padding: 15px; border-radius: 12px; font-weight: 600; border: none; font-size: 16px; cursor: pointer; width: 100%; }
        .btn-save { background: var(--green); color: black; margin-bottom: 10px; }
        .btn-reset { background: transparent; color: var(--danger); border: 1px solid #3a3a3c; font-size: 12px; padding: 10px; margin-top: 10px;}
    </style>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body>
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
        <h2 style="margin:0;">üöÅ Admin <span style="color:var(--accent)">PRO</span></h2>
    </div>
    <div class="stats-grid">
        <div class="stat-card"><span class="stat-val" style="color:var(--green)" id="online-count">0</span><span class="stat-label">Online</span></div>
        <div class="stat-card"><span class="stat-val" id="total-count">0</span><span class="stat-label">–ò–≥—Ä–æ–∫–æ–≤</span></div>
        <div class="stat-card"><span class="stat-val" style="color:var(--gold)" id="rich-count">0</span><span class="stat-label">–ë–æ–≥–∞—á–µ–π</span></div>
    </div>
    <div id="users-container" class="users-list"></div>

    <div id="editor-modal">
        <div class="editor-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h3 id="edit-title" style="margin:0;">–ò–≥—Ä–æ–∫</h3>
                <button onclick="closeEditor()" style="background:none; border:none; color:#aaa; font-size:20px;">‚úï</button>
            </div>
            <input type="number" id="inp-money" class="form-input" placeholder="PLN">
            <input type="number" id="inp-lvl" class="form-input" placeholder="LVL">
            <button class="btn-action-modal btn-save" onclick="saveUserChanges()">üíæ –°–û–•–†–ê–ù–ò–¢–¨</button>
            <button class="btn-action-modal btn-reset" onclick="resetUserFull()">‚ôªÔ∏è –ü–û–õ–ù–´–ô –°–ë–†–û–° (WIPE)</button>
        </div>
    </div>

    <script>
        const firebaseConfig = {
          apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk",
          authDomain: "warszawa-courier.firebaseapp.com",
          databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app",
          projectId: "warszawa-courier",
          storageBucket: "warszawa-courier.firebasestorage.app",
          messagingSenderId: "295860613508",
          appId: "1:295860613508:web:86fe8364377d6875612dd1",
          measurementId: "G-TGSCHBVLX2"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        let allUsers = {};
        let currentEditId = null;

        db.ref('users').on('value', (snapshot) => {
            allUsers = snapshot.val() || {};
            renderCards();
        });

        function renderCards() {
            const container = document.getElementById('users-container');
            container.innerHTML = '';
            Object.entries(allUsers).forEach(([id, user]) => {
                const card = document.createElement('div');
                card.className = 'user-card';
                card.innerHTML = `
                    <div class="user-header"><b>${user.name || id}</b></div>
                    <div class="user-stats">
                        <div class="stat-box"><b>${(user.money||0).toFixed(2)}</b><small>PLN</small></div>
                        <div class="stat-box"><b>${(user.lvl||1).toFixed(2)}</b><small>LVL</small></div>
                    </div>
                    <button class="btn-manage" onclick="openEditor('${id}')">–£–ü–†–ê–í–õ–ï–ù–ò–ï ‚öôÔ∏è</button>
                `;
                container.appendChild(card);
            });
        }

        function openEditor(id) {
            currentEditId = id;
            const user = allUsers[id];
            document.getElementById('edit-title').innerText = user.name || "–ò–≥—Ä–æ–∫";
            document.getElementById('inp-money').value = user.money;
            document.getElementById('inp-lvl').value = user.lvl;
            const modal = document.getElementById('editor-modal');
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('show'), 10);
        }

        function closeEditor() {
            const modal = document.getElementById('editor-modal');
            modal.classList.remove('show');
            setTimeout(() => modal.style.display = 'none', 300);
        }

        function saveUserChanges() {
            if(!currentEditId) return;
            const updates = {
                money: parseFloat(document.getElementById('inp-money').value),
                lvl: parseFloat(document.getElementById('inp-lvl').value),
                lastAdminUpdate: Date.now()
            };
            db.ref('users/' + currentEditId).update(updates).then(closeEditor);
        }

        function resetUserFull() {
            if(!currentEditId || !confirm("–£–î–ê–õ–ò–¢–¨ –í–ï–°–¨ –ü–†–û–ì–†–ï–°–° –ò –ö–í–ê–†–¢–ò–†–´?")) return;
            const user = allUsers[currentEditId];
            const wipeData = {
                name: user.name, user: user.user, lastActive: Date.now(), lastAdminUpdate: Date.now(),
                money: 10.00, lvl: 1.0, en: 2000, waterStock: 0, totalOrders: 0, totalClicks: 0,
                totalBottles: 0, totalEarned: 0, housing: { id: -1 }, // –°–ë–†–û–° –¢–£–¢
                shoes: { name: "Tapki", maxDur: 100, dur: 100, bonus: 0 },
                transportMode: 'none', isNewPlayer: true, history: [], usedPromos: [],
                activeMilestones: [
                    { id: 1, name: "üì¶ –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏", goal: 10, type: 'orders', reward: 30 }, 
                    { id: 2, name: "üß¥ –≠–∫–æ-–∞–∫—Ç–∏–≤–∏—Å—Ç", goal: 50, type: 'bottles', reward: 20 }, 
                    { id: 3, name: "‚ö° –≠–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä", goal: 1000, type: 'clicks', reward: 40 }
                ]
            };
            db.ref('users/' + currentEditId).set(wipeData).then(closeEditor);
        }
    </script>
</body>
</html>

