<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Courier V4</title>
    <style>
        :root {
            --bg-color: #050510;
            --primary: #00f3ff;
            --secondary: #ff00ff;
            --pickup: #ffff00;
            --danger: #ff3333;
            --gold: #ffd700;
            --panel-bg: rgba(15, 15, 35, 1);
            --grid-line: rgba(255, 255, 255, 0.04);
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: #fff;
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden; /* –£–±–∏—Ä–∞–µ–º —Å–∫—Ä–æ–ª–ª */
            touch-action: manipulation;
            display: flex;
            flex-direction: column;
            height: 100vh; /* –†–æ–≤–Ω–æ –≤—ã—Å–æ—Ç–∞ —ç–∫—Ä–∞–Ω–∞ */
            width: 100vw;
        }

        /* --- 1. –í–ï–†–•–ù–ï–ï –ú–ï–ù–Æ (HUD) --- */
        .hud {
            flex-shrink: 0; /* –ù–µ —Å–∂–∏–º–∞—Ç—å */
            display: flex;
            justify-content: space-between;
            padding: 10px 15px;
            background: #000;
            border-bottom: 1px solid #333;
            z-index: 10;
            height: 50px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ */
            box-sizing: border-box;
        }

        .stat-group { text-align: center; min-width: 60px; }
        .stat-label { font-size: 9px; color: #888; text-transform: uppercase; margin-bottom: 2px; }
        .stat-val { font-size: 16px; font-weight: bold; text-shadow: 0 0 5px currentColor; }

        /* --- 2. –ö–û–ù–¢–ï–ô–ù–ï–† –ö–ê–†–¢–´ (–°–ï–†–ï–î–ò–ù–ê) --- */
        #game-container {
            flex: 1; /* –ó–∞–Ω–∏–º–∞–µ—Ç –í–°–ï —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –º–µ–∂–¥—É –≤–µ—Ä—Ö–æ–º –∏ –Ω–∏–∑–æ–º */
            display: flex;
            align-items: center;     /* –¶–µ–Ω—Ç—Ä –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
            justify-content: center; /* –¶–µ–Ω—Ç—Ä –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ */
            position: relative;
            overflow: hidden;
            width: 100%;
        }

        #game-map {
            display: grid;
            background: 
                linear-gradient(var(--grid-line) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-line) 1px, transparent 1px);
            background-size: 100% 100%;
            gap: 1px;
            padding: 2px;
            border: 1px solid rgba(255,255,255,0.1);
            
            /* –ê–î–ê–ü–¢–ò–í–ù–´–ô –†–ê–ó–ú–ï–†: 
               –ö–∞—Ä—Ç–∞ –±—É–¥–µ—Ç –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π. 
               –û–Ω–∞ –∑–∞–π–º–µ—Ç –º–∞–∫—Å–∏–º—É–º 95% —à–∏—Ä–∏–Ω—ã —ç–∫—Ä–∞–Ω–∞ 
               –ò–õ–ò 60% –≤—ã—Å–æ—Ç—ã —ç–∫—Ä–∞–Ω–∞ (—á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –º–µ—Å—Ç–æ –∫–Ω–æ–ø–∫–∞–º).
            */
            width: 90vmin;
            height: 90vmin;
            max-width: 95vw;
            max-height: 55vh; /* –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã, —á—Ç–æ–±—ã –Ω–µ –ª–µ–∑—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫–∏ */
            aspect-ratio: 1/1; /* –í—Å–µ–≥–¥–∞ –∫–≤–∞–¥—Ä–∞—Ç */
        }

        .cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px; 
            position: relative;
            border-radius: 2px;
        }
        
        /* –≠—Ñ—Ñ–µ–∫—Ç—ã */
        .player-glow { filter: drop-shadow(0 0 4px var(--primary)); z-index: 5; font-size: 18px; }
        .pickup-glow { filter: drop-shadow(0 0 6px var(--pickup)); animation: pulse 1s infinite; z-index: 4; }
        .delivery-glow { filter: drop-shadow(0 0 6px var(--secondary)); animation: pulse 1s infinite; z-index: 4; }
        .wall-glow { opacity: 0.5; filter: drop-shadow(0 0 2px var(--danger)); font-size: 14px; }

        /* --- 3. –ù–ò–ñ–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ (–ö–ù–û–ü–ö–ò) --- */
        .controls-wrapper {
            flex-shrink: 0; /* –ù–µ —Å–∂–∏–º–∞—Ç—å */
            background: var(--bg-color); /* –§–æ–Ω, —á—Ç–æ–±—ã –ø–µ—Ä–µ–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—É –µ—Å–ª–∏ —á—Ç–æ */
            width: 100%;
            display: flex;
            justify-content: center;
            padding-bottom: 20px; /* –û—Ç—Å—Ç—É–ø –æ—Ç —Å–∞–º–æ–≥–æ –Ω–∏–∑–∞ —ç–∫—Ä–∞–Ω–∞ */
            padding-top: 10px;
            z-index: 20;
        }

        .controls-pad {
            background: var(--panel-bg);
            padding: 10px;
            border-radius: 20px;
            border: 1px solid var(--primary);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.15);
            
            display: grid;
            grid-template-columns: 65px 65px 65px; /* –ö–Ω–æ–ø–∫–∏ –ø–æ—à–∏—Ä–µ */
            grid-template-rows: 55px 55px;
            gap: 6px;
        }

        .btn {
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            color: var(--primary);
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .btn:active { background: var(--primary); color: #000; transform: scale(0.95); }
        .btn-action { border-color: var(--gold); color: var(--gold); background: rgba(255, 215, 0, 0.1); }
        
        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        #msg-log {
            position: absolute;
            top: 50%; left: 50%; 
            transform: translate(-50%, -50%);
            font-size: 14px; font-weight: bold;
            background: rgba(0,0,0,0.9);
            padding: 8px 16px; border-radius: 10px;
            border: 1px solid #fff;
            pointer-events: none; opacity: 0; transition: opacity 0.3s; z-index: 100; text-align: center;
            white-space: nowrap;
        }

        @keyframes pulse { 0% {transform: scale(0.9);} 50% {transform: scale(1.2);} 100% {transform: scale(0.9);} }
    </style>
</head>
<body>

    <div class="hud">
        <div class="stat-group">
            <div class="stat-label">–ë–∞–ª–∞–Ω—Å</div>
            <div class="stat-val" style="color: var(--gold)" id="ui-balance">0</div>
        </div>
        <div class="stat-group">
            <div class="stat-label">–ó–∞—Ä—è–¥</div>
            <div class="stat-val" style="color: var(--primary)" id="ui-energy">100%</div>
        </div>
        <div class="stat-group">
            <div class="stat-label">–¶–µ–ª—å</div>
            <div class="stat-val" style="font-size: 12px; color: var(--pickup)" id="ui-status">–ü–û–ò–°–ö</div>
        </div>
    </div>

    <div id="game-container">
        <div id="msg-log"></div>
        <div id="game-map"></div>
    </div>

    <div class="controls-wrapper">
        <div class="controls-pad">
            <div></div>
            <div class="btn" onclick="move(0, -1)">‚ñ≤</div>
            <div></div>
            
            <div class="btn" onclick="move(-1, 0)">‚óÄ</div>
            <div class="btn btn-action" onclick="actionBoost()">‚ö°</div>
            <div class="btn" onclick="move(1, 0)">‚ñ∂</div>
            
            <div></div>
            <div class="btn" onclick="move(0, 1)">‚ñº</div>
            <div></div>
        </div>
    </div>

    <script>
        // --- –ö–û–ù–§–ò–ì ---
        const GRID_SIZE = 13; 
        
        let state = {
            x: 6, y: 6,        
            objective: {x:0, y:0},
            hasPackage: false,
            walls: [],
            balance: 0,
            energy: 100
        };

        const mapEl = document.getElementById('game-map');

        function initGame() {
            mapEl.style.gridTemplateColumns = `repeat(${GRID_SIZE}, 1fr)`;
            mapEl.style.gridTemplateRows = `repeat(${GRID_SIZE}, 1fr)`;
            
            mapEl.innerHTML = '';
            for(let i=0; i<GRID_SIZE*GRID_SIZE; i++) {
                let cell = document.createElement('div');
                cell.className = 'cell';
                cell.id = `c-${i}`;
                mapEl.appendChild(cell);
            }
            
            spawnObjective();
            generateWalls();
            draw();
            updateUI();
        }

        function getIdx(x, y) { return y * GRID_SIZE + x; }

        function generateWalls() {
            state.walls = [];
            for(let i=0; i<25; i++) {
                let wx, wy;
                do {
                    wx = Math.floor(Math.random() * GRID_SIZE);
                    wy = Math.floor(Math.random() * GRID_SIZE);
                } while ((wx === state.x && wy === state.y) || (wx === state.objective.x && wy === state.objective.y));
                state.walls.push(getIdx(wx, wy));
            }
        }

        function spawnObjective() {
            do {
                state.objective.x = Math.floor(Math.random() * GRID_SIZE);
                state.objective.y = Math.floor(Math.random() * GRID_SIZE);
            } while (state.objective.x === state.x && state.objective.y === state.y);
            
            if(state.hasPackage) generateWalls(); 
            draw();
            updateUI();
        }

        function move(dx, dy) {
            if (state.energy <= 0) { showMsg("ü™´ –°–ï–õ–ê –ë–ê–¢–ê–†–ï–Ø!", "red"); return; }

            let nx = state.x + dx;
            let ny = state.y + dy;

            if (nx < 0 || nx >= GRID_SIZE || ny < 0 || ny >= GRID_SIZE) return;

            let nIdx = getIdx(nx, ny);
            if (state.walls.includes(nIdx)) {
                showMsg("üöß –¢–£–ü–ò–ö!", "#ff9900");
                state.energy -= 2;
                updateUI();
                return;
            }

            state.x = nx;
            state.y = ny;
            state.energy -= 1;

            if (state.x === state.objective.x && state.y === state.objective.y) {
                if (!state.hasPackage) {
                    state.hasPackage = true;
                    showMsg("üéí –í–ï–ó–ò –ö–õ–ò–ï–ù–¢–£", "#ffff00");
                    spawnObjective();
                } else {
                    state.hasPackage = false;
                    let profit = 20 + Math.floor(Math.random() * 15);
                    state.balance += profit;
                    showMsg(`‚úÖ +${profit} PLN`, "#00f3ff");
                    generateWalls();
                    spawnObjective();
                }
            }
            draw();
            updateUI();
        }

        function actionBoost() {
            if (state.balance >= 15) {
                state.balance -= 15;
                state.energy = Math.min(100, state.energy + 50);
                showMsg("‚ö° –ó–ê–†–Ø–ñ–ï–ù–û!", "#00ff00");
                updateUI();
            } else { showMsg("‚ùå –ù–ï–¢ –î–ï–ù–ï–ì", "red"); }
        }

        function draw() {
            document.querySelectorAll('.cell').forEach(c => {
                c.className = 'cell';
                c.innerText = '';
            });

            state.walls.forEach(idx => {
                let c = document.getElementById(`c-${idx}`);
                c.innerText = 'üöß';
                c.classList.add('wall-glow');
            });

            let tIdx = getIdx(state.objective.x, state.objective.y);
            let tCell = document.getElementById(`c-${tIdx}`);
            if (!state.hasPackage) {
                tCell.innerText = 'üè™';
                tCell.classList.add('pickup-glow');
            } else {
                tCell.innerText = 'üè†';
                tCell.classList.add('delivery-glow');
            }

            let pIdx = getIdx(state.x, state.y);
            let pCell = document.getElementById(`c-${pIdx}`);
            pCell.innerText = 'üõµ';
            pCell.classList.add('player-glow');
        }

        function updateUI() {
            document.getElementById('ui-balance').innerText = state.balance.toFixed(0);
            let enEl = document.getElementById('ui-energy');
            enEl.innerText = Math.floor(state.energy) + '%';
            enEl.style.color = state.energy < 30 ? 'red' : 'var(--primary)';

            let statusEl = document.getElementById('ui-status');
            if(!state.hasPackage) {
                 statusEl.innerText = "–í –†–ï–°–¢–û–†–ê–ù";
                 statusEl.style.color = "var(--pickup)";
            } else {
                 statusEl.innerText = "–ö –ö–õ–ò–ï–ù–¢–£";
                 statusEl.style.color = "var(--secondary)";
            }
        }

        function showMsg(text, color) {
            let el = document.getElementById('msg-log');
            el.innerText = text;
            el.style.color = color;
            el.style.borderColor = color;
            el.style.opacity = 1;
            setTimeout(() => el.style.opacity = 0, 1500);
        }

        initGame();
    </script>
</body>
</html>
