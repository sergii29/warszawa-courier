<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Warsaw Royal Casino</title>
    <style>
        :root {
            --bg: #0f172a; /* Dark Blue/Black */
            --card: #1e293b;
            --primary: #fbbf24; /* Gold */
            --accent: #10b981; /* Green Money */
            --danger: #ef4444;
            --text: #f8fafc;
            --nav-height: 65px;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; padding: 0;
            background: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', Roboto, sans-serif;
            height: 100vh; width: 100vw;
            display: flex; flex-direction: column;
            overflow: hidden;
        }

        /* --- TOP BAR --- */
        .top-bar {
            height: 60px;
            background: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(10px);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 15px;
            border-bottom: 1px solid #334155;
            z-index: 50;
        }
        .balance-box { display: flex; flex-direction: column; }
        .bal-val { font-size: 1.1em; font-weight: 800; color: var(--accent); }
        .lvl-box { font-size: 0.8em; color: var(--primary); text-align: right; }

        /* --- CONTENT AREA --- */
        .content { flex: 1; overflow-y: auto; position: relative; }
        .view { display: none; padding: 15px; padding-bottom: 80px; min-height: 100%; }
        .view.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- LOBBY (GAMES GRID) --- */
        .lobby-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;
        }
        .game-card {
            background: linear-gradient(145deg, #1e293b, #0f172a);
            border: 1px solid #334155;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .game-card:active { transform: scale(0.96); border-color: var(--primary); }
        .g-icon { font-size: 2.5em; margin-bottom: 10px; display: block; }
        .g-title { font-weight: 700; font-size: 0.9em; }
        .g-desc { font-size: 0.7em; color: #94a3b8; margin-top: 5px; }

        /* --- GAME ROOM STYLES --- */
        .game-room { text-align: center; display: flex; flex-direction: column; gap: 15px; height: 100%; }
        .game-display {
            background: #000;
            border: 2px solid var(--primary);
            border-radius: 15px;
            height: 150px;
            display: flex; align-items: center; justify-content: center;
            font-size: 3em;
            position: relative;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.2);
        }
        .bet-controls {
            background: var(--card); padding: 15px; border-radius: 15px;
        }
        .input-group { display: flex; gap: 10px; margin-bottom: 10px; }
        .bet-input {
            flex: 1; background: #0f172a; border: 1px solid #475569;
            color: white; padding: 10px; border-radius: 8px; font-size: 1.1em; text-align: center;
        }
        .btn-action {
            width: 100%; padding: 15px; border: none; border-radius: 10px;
            font-weight: 800; font-size: 1.1em; cursor: pointer;
            background: var(--primary); color: #000;
        }
        .btn-back { background: transparent; border: 1px solid #475569; color: #cbd5e1; width: auto; padding: 8px 15px; margin-bottom: 10px; border-radius: 8px; }

        /* --- WORK/BANK TAB --- */
        .work-btn {
            width: 100%; height: 120px;
            background: linear-gradient(135deg, #10b981, #059669);
            border: none; border-radius: 20px;
            color: white; font-size: 1.5em; font-weight: bold;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        }
        .work-btn:active { transform: scale(0.98); }

        /* --- BOTTOM NAV --- */
        .nav {
            height: var(--nav-height);
            background: var(--card);
            border-top: 1px solid #334155;
            display: flex; justify-content: space-around; align-items: center;
            position: absolute; bottom: 0; width: 100%;
        }
        .nav-item {
            color: #64748b; text-align: center; font-size: 0.7em;
            display: flex; flex-direction: column; gap: 4px; padding: 10px;
        }
        .nav-item.active { color: var(--primary); }
        .nav-icon { font-size: 1.5em; }

        /* --- TOAST & LOGS --- */
        #toast {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9); padding: 15px 25px; border-radius: 25px;
            color: #fff; opacity: 0; pointer-events: none; transition: 0.2s; z-index: 100; font-weight: bold;
            border: 1px solid var(--primary); text-align: center;
        }
        .win { color: #4ade80; }
        .lose { color: #f87171; }
    </style>
</head>
<body>

<div class="top-bar">
    <div class="balance-box">
        <span style="font-size:0.7em; color:#94a3b8">–ë–ê–õ–ê–ù–°</span>
        <span class="bal-val" id="ui-money">0 PLN</span>
    </div>
    <div class="lvl-box">
        <div id="ui-lvl-badge">LVL 1</div>
        <div style="font-size:0.8em; color:#fff" id="ui-maxbet">Max: 100</div>
    </div>
</div>

<div class="content">
    <div id="view-lobby" class="view active">
        <h2 style="margin-top:0">–ò–≥—Ä–æ–≤–æ–π –ó–∞–ª</h2>
        <div class="lobby-grid">
            <div class="game-card" onclick="openGame('slots')">
                <span class="g-icon">üé∞</span>
                <div class="g-title">Royal Slots</div>
                <div class="g-desc">–ö–ª–∞—Å—Å–∏–∫–∞ x5</div>
            </div>
            <div class="game-card" onclick="openGame('roulette')">
                <span class="g-icon">üî¥</span>
                <div class="g-title">–†—É–ª–µ—Ç–∫–∞</div>
                <div class="g-desc">–ö—Ä–∞—Å–Ω–æ–µ/–ß–µ—Ä–Ω–æ–µ x2</div>
            </div>
            <div class="game-card" onclick="openGame('dice')">
                <span class="g-icon">üé≤</span>
                <div class="g-title">–ö–æ—Å—Ç–∏ Hi-Lo</div>
                <div class="g-desc">–í—ã—à–µ/–ù–∏–∂–µ x2</div>
            </div>
            <div class="game-card" onclick="openGame('coin')">
                <span class="g-icon">ü™ô</span>
                <div class="g-title">–û—Ä–µ–ª/–†–µ—à–∫–∞</div>
                <div class="g-desc">–®–∞–Ω—Å 50/50</div>
            </div>
            <div class="game-card" onclick="openGame('thimbles')">
                <span class="g-icon">ü•§</span>
                <div class="g-title">–ù–∞–ø–µ—Ä—Å—Ç–∫–∏</div>
                <div class="g-desc">–£–≥–∞–¥–∞–π –≥–¥–µ x3</div>
            </div>
            <div class="game-card" onclick="openGame('crash')">
                <span class="g-icon">üöÄ</span>
                <div class="g-title">Crash Rocket</div>
                <div class="g-desc">–£—Å–ø–µ–π –∑–∞–±—Ä–∞—Ç—å</div>
            </div>
             <div class="game-card" onclick="openGame('lottery')">
                <span class="g-icon">üé´</span>
                <div class="g-title">–õ–æ—Ç–µ—Ä–µ—è</div>
                <div class="g-desc">–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —à–∞–Ω—Å</div>
            </div>
             <div class="game-card" onclick="alert('–°–∫–æ—Ä–æ! –ù—É–∂–Ω–æ –ø–æ–≤—ã—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å.')">
                <span class="g-icon">üîí</span>
                <div class="g-title">VIP –ü–æ–∫–µ—Ä</div>
                <div class="g-desc">–¢–æ–ª—å–∫–æ LVL 10+</div>
            </div>
        </div>
    </div>

    <div id="view-bank" class="view">
        <h2 style="margin-top:0">–ë–∞–Ω–∫–æ–º–∞—Ç / –†–∞–±–æ—Ç–∞</h2>
        <p style="color:#94a3b8">–ö–æ–Ω—á–∏–ª–∏—Å—å –¥–µ–Ω—å–≥–∏? –ó–∞—Ä–∞–±–æ—Ç–∞–π—Ç–µ –∏—Ö –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∏–≥—Ä—É.</p>
        
        <button class="work-btn" id="btn-click" onclick="doWork()">
            <span>‚õèÔ∏è +<span id="ui-click-rate">10</span> PLN</span>
            <span style="font-size:0.5em; font-weight:normal; opacity:0.8">–ö–ª–∏–∫–∞–π –∏ –±–æ–≥–∞—Ç–µ–π</span>
        </button>

        <div style="margin-top:30px; background:var(--card); padding:15px; border-radius:15px;">
            <h3>–ü—Ä–æ–∫–∞—á–∫–∞ –∑–∞—Ä–∞–±–æ—Ç–∫–∞</h3>
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                <span>–ö—É—Ä—Å—ã –±—Ä–æ–∫–µ—Ä–∞ (+5 –∫ –∫–ª–∏–∫—É)</span>
                <button onclick="upgradeClick()" style="background:var(--primary); border:none; border-radius:5px; padding:5px 10px;">250 PLN</button>
            </div>
        </div>
    </div>

    <div id="view-gameroom" class="view">
        <button class="btn-back" onclick="closeGame()">‚Üê –ù–∞–∑–∞–¥ –≤ –ª–æ–±–±–∏</button>
        <div class="game-room" id="game-engine-container">
            </div>
    </div>
</div>

<div class="nav">
    <div class="nav-item active" onclick="switchTab('lobby', this)">
        <span class="nav-icon">üè∞</span>
        <span>–õ–æ–±–±–∏</span>
    </div>
    <div class="nav-item" onclick="switchTab('bank', this)">
        <span class="nav-icon">üè¶</span>
        <span>–ë–∞–Ω–∫</span>
    </div>
    <div class="nav-item" onclick="resetGame()">
        <span class="nav-icon">‚öôÔ∏è</span>
        <span>–°–±—Ä–æ—Å</span>
    </div>
</div>

<div id="toast"></div>

<script>
    // --- STATE & CONFIG ---
    const KEY = 'WARSZAWA_CASINO_V1';
    let state = {
        money: 100, // –°—Ç–∞—Ä—Ç–æ–≤—ã–π –±–æ–Ω—É—Å
        xp: 0,
        level: 1,
        clickPower: 10,
        maxBet: 100
    };

    let currentGameId = null;

    // --- INIT ---
    function init() {
        let s = localStorage.getItem(KEY);
        if(s) state = {...state, ...JSON.parse(s)};
        updateUI();
    }

    // --- GAME LOGIC ---
    
    // 1. UTILS
    function save() { localStorage.setItem(KEY, JSON.stringify(state)); }
    
    function addMoney(amount) {
        state.money += amount;
        updateUI();
        save();
    }
    
    function addXp(betAmount) {
        // XP –¥–∞–µ—Ç—Å—è –∑–∞ –æ–±–æ—Ä–æ—Ç (—Å—Ç–∞–≤–∫–∏), –∞ –Ω–µ –∑–∞ –≤—ã–∏–≥—Ä—ã—à
        state.xp += Math.abs(betAmount) * 0.1;
        
        let req = state.level * 500;
        if(state.xp >= req) {
            state.level++;
            state.xp = 0;
            state.maxBet = Math.floor(100 * Math.pow(2, state.level-1));
            showToast(`üéâ –£—Ä–æ–≤–µ–Ω—å ${state.level}! –ú–∞–∫—Å. —Å—Ç–∞–≤–∫–∞: ${state.maxBet}`);
        }
        updateUI();
    }

    function getBet() {
        let inp = document.getElementById('bet-input');
        let val = parseInt(inp.value);
        if(isNaN(val) || val <= 0) { showToast("–í–≤–µ–¥–∏—Ç–µ —Å—Ç–∞–≤–∫—É!"); return null; }
        if(val > state.money) { showToast("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–µ–Ω–µ–≥!"); return null; }
        if(val > state.maxBet) { showToast(`–õ–∏–º–∏—Ç —É—Ä–æ–≤–Ω—è: ${state.maxBet}`); return null; }
        return val;
    }

    // 2. GAMES ENGINE
    const games = {
        slots: {
            title: "Royal Slots",
            render: () => `
                <div class="game-display" id="slot-screen">üçí üçí üçí</div>
                <div class="bet-controls">
                    <div class="input-group">
                        <input type="number" id="bet-input" class="bet-input" value="10" placeholder="–°—Ç–∞–≤–∫–∞">
                    </div>
                    <button class="btn-action" onclick="games.slots.play()">–ö–†–£–¢–ò–¢–¨ (x5)</button>
                </div>
            `,
            play: () => {
                let bet = getBet();
                if(!bet) return;
                
                addMoney(-bet);
                addXp(bet);
                
                let screen = document.getElementById('slot-screen');
                let symbols = ['üçí','üçã','üçá','üíé','7Ô∏è‚É£'];
                
                // Animation loop
                let spins = 0;
                let interval = setInterval(() => {
                    screen.innerText = 
                        symbols[Math.floor(Math.random()*symbols.length)] + " " +
                        symbols[Math.floor(Math.random()*symbols.length)] + " " +
                        symbols[Math.floor(Math.random()*symbols.length)];
                    spins++;
                    if(spins > 10) {
                        clearInterval(interval);
                        // Result
                        let r1 = symbols[Math.floor(Math.random()*symbols.length)];
                        let r2 = symbols[Math.floor(Math.random()*symbols.length)];
                        let r3 = symbols[Math.floor(Math.random()*symbols.length)];
                        
                        // Rigging: Small chance to win big
                        if(Math.random() < 0.15) { r1=r2=r3; } 
                        
                        screen.innerText = `${r1} ${r2} ${r3}`;
                        
                        if(r1 === r2 && r2 === r3) {
                            let win = bet * 5;
                            addMoney(win);
                            showToast(`JACKPOT! +${win}`, 'win');
                        } else if(r1 === r2 || r2 === r3 || r1 === r3) {
                            let win = Math.floor(bet * 1.5);
                            addMoney(win);
                            showToast(`–ü–∞—Ä–∞! +${win}`, 'win');
                        } else {
                            showToast(`–ü—É—Å—Ç–æ...`, 'lose');
                        }
                    }
                }, 50);
            }
        },
        roulette: {
            title: "Roulette",
            render: () => `
                <div class="game-display" style="font-size:4em" id="roulette-screen">üé°</div>
                <div class="bet-controls">
                    <input type="number" id="bet-input" class="bet-input" value="10" style="margin-bottom:10px; width:100%">
                    <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:5px;">
                        <button class="btn-action" style="background:#ef4444" onclick="games.roulette.play('red')">–ö–†–ê–°–ù</button>
                        <button class="btn-action" style="background:#22c55e" onclick="games.roulette.play('zero')">0</button>
                        <button class="btn-action" style="background:#1e293b; border:1px solid #fff; color:white;" onclick="games.roulette.play('black')">–ß–ï–†–ù</button>
                    </div>
                </div>
            `,
            play: (choice) => {
                let bet = getBet();
                if(!bet) return;
                addMoney(-bet); addXp(bet);

                let screen = document.getElementById('roulette-screen');
                screen.innerText = "üé≤...";
                
                setTimeout(() => {
                    let num = Math.floor(Math.random() * 37); // 0-36
                    let color = (num === 0) ? 'zero' : (num % 2 === 0 ? 'black' : 'red');
                    
                    screen.innerHTML = `<span style="color:${color==='red'?'#ef4444':(color==='black'?'#fff':'#22c55e')}">${num}</span>`;
                    
                    if(choice === color) {
                        let mult = (choice === 'zero') ? 14 : 2;
                        addMoney(bet * mult);
                        showToast(`–ü–æ–±–µ–¥–∞! +${bet*mult}`, 'win');
                    } else {
                        showToast("–ú–∏–º–æ", 'lose');
                    }
                }, 500);
            }
        },
        dice: {
            title: "Dice Hi-Lo",
            render: () => `
                <div class="game-display" id="dice-screen">üé≤</div>
                <div class="bet-controls">
                    <input type="number" id="bet-input" class="bet-input" value="10" style="width:100%; margin-bottom:10px;">
                    <div style="display:flex; gap:10px;">
                        <button class="btn-action" onclick="games.dice.play('lo')">LO (1-3)</button>
                        <button class="btn-action" onclick="games.dice.play('hi')">HI (4-6)</button>
                    </div>
                </div>
            `,
            play: (choice) => {
                let bet = getBet(); if(!bet) return;
                addMoney(-bet); addXp(bet);
                
                let val = Math.floor(Math.random() * 6) + 1;
                document.getElementById('dice-screen').innerText = val;
                
                let win = false;
                if(choice === 'lo' && val <= 3) win = true;
                if(choice === 'hi' && val >= 4) win = true;
                
                if(win) { addMoney(bet*2); showToast(`–í–µ—Ä–Ω–æ! +${bet*2}`, 'win'); }
                else { showToast('–ù–µ–≤–µ—Ä–Ω–æ', 'lose'); }
            }
        },
        coin: {
            title: "–û—Ä–µ–ª –∏ –†–µ—à–∫–∞",
            render: () => `
                <div class="game-display" id="coin-screen" style="font-size:4em">ü™ô</div>
                <div class="bet-controls">
                    <input type="number" id="bet-input" class="bet-input" value="10" style="width:100%; margin-bottom:10px;">
                    <div style="display:flex; gap:10px;">
                        <button class="btn-action" style="background:#fbbf24; color:black" onclick="games.coin.play(0)">–û–†–ï–õ</button>
                        <button class="btn-action" style="background:#94a3b8; color:black" onclick="games.coin.play(1)">–†–ï–®–ö–ê</button>
                    </div>
                </div>
            `,
            play: (pick) => {
                let bet = getBet(); if(!bet) return;
                addMoney(-bet); addXp(bet);
                
                let screen = document.getElementById('coin-screen');
                screen.style.transform = "rotateY(720deg)";
                screen.style.transition = "1s";
                
                setTimeout(() => {
                    screen.style.transform = "rotateY(0deg)";
                    let res = Math.random() < 0.5 ? 0 : 1;
                    screen.innerText = res === 0 ? "ü¶Ö" : "üåï";
                    
                    if(pick === res) { addMoney(bet*1.9); showToast(`–ü–æ–±–µ–¥–∞!`, 'win'); }
                    else { showToast(`–ü—Ä–æ–∏–≥—Ä—ã—à`, 'lose'); }
                }, 1000);
            }
        },
        crash: {
            title: "Crash Rocket",
            render: () => `
                <div class="game-display" id="crash-screen" style="font-family:monospace">1.00x</div>
                <div class="bet-controls">
                    <input type="number" id="bet-input" class="bet-input" value="10" style="width:100%; margin-bottom:10px;">
                    <button class="btn-action" id="crash-btn" onclick="games.crash.start()">–ó–ê–ü–£–°–ö</button>
                </div>
            `,
            active: false,
            currMult: 1.0,
            interval: null,
            bet: 0,
            start: () => {
                let bet = getBet(); if(!bet) return;
                games.crash.bet = bet;
                addMoney(-bet);
                
                let btn = document.getElementById('crash-btn');
                btn.innerText = "–°–¢–û–ü";
                btn.style.background = "#ef4444";
                btn.onclick = games.crash.stop;
                
                games.crash.active = true;
                games.crash.currMult = 1.0;
                
                // Crash point calculation
                let crashPoint = (Math.random() * 5) + 1;
                if(Math.random() < 0.3) crashPoint = 1.1; // 30% instant crash
                
                games.crash.interval = setInterval(() => {
                    if(!games.crash.active) return;
                    games.crash.currMult += 0.05;
                    document.getElementById('crash-screen').innerText = games.crash.currMult.toFixed(2) + "x";
                    
                    if(games.crash.currMult >= crashPoint) {
                        games.crash.crash();
                    }
                }, 100);
            },
            stop: () => {
                if(!games.crash.active) return;
                games.crash.active = false;
                clearInterval(games.crash.interval);
                
                let win = Math.floor(games.crash.bet * games.crash.currMult);
                addMoney(win);
                addXp(games.crash.bet);
                showToast(`–ó–∞–±—Ä–∞–ª: ${win}`, 'win');
                games.crash.resetBtn();
            },
            crash: () => {
                games.crash.active = false;
                clearInterval(games.crash.interval);
                document.getElementById('crash-screen').innerText = "üí• CRASH";
                document.getElementById('crash-screen').style.color = "red";
                showToast("–í–∑–æ—Ä–≤–∞–ª—Å—è...", 'lose');
                addXp(games.crash.bet); // XP even for loss
                games.crash.resetBtn();
            },
            resetBtn: () => {
                let btn = document.getElementById('crash-btn');
                btn.innerText = "–ó–ê–ü–£–°–ö";
                btn.style.background = "#fbbf24";
                btn.onclick = games.crash.start;
                setTimeout(() => { document.getElementById('crash-screen').style.color = "white"; }, 2000);
            }
        },
        lottery: {
             title: "Lottery Scratch",
            render: () => `
                <div class="game-display" id="loto-screen" style="flex-direction:column; font-size:1em;">
                    <div style="font-size:2em">üé´ üé´ üé´</div>
                    <div>–¶–µ–Ω–∞ –±–∏–ª–µ—Ç–∞: 50 PLN</div>
                </div>
                <div class="bet-controls">
                     <button class="btn-action" onclick="games.lottery.play()">–ö–£–ü–ò–¢–¨ –ë–ò–õ–ï–¢ (50)</button>
                </div>
            `,
            play: () => {
                if(state.money < 50) { showToast("–ù–µ—Ç 50 PLN"); return; }
                addMoney(-50); addXp(50);
                
                let r = Math.random();
                let win = 0;
                let msg = "–ü—É—Å—Ç–æ–π –±–∏–ª–µ—Ç";
                
                if(r < 0.05) { win = 1000; msg = "–°–£–ü–ï–† –ü–†–ò–ó!"; }
                else if(r < 0.2) { win = 150; msg = "–ú–∞–ª—ã–π –ø—Ä–∏–∑"; }
                else if(r < 0.4) { win = 50; msg = "–í–æ–∑–≤—Ä–∞—Ç"; }
                
                document.getElementById('loto-screen').innerHTML = `
                    <div style="font-size:1.5em; font-weight:bold; color:${win>0?var(--primary):'white'}">${msg}</div>
                    <div>+${win} PLN</div>
                `;
                
                if(win > 0) addMoney(win);
            }
        }
    };

    // --- VIEW CONTROLLERS ---

    function updateUI() {
        document.getElementById('ui-money').innerText = Math.floor(state.money).toLocaleString() + ' PLN';
        document.getElementById('ui-lvl-badge').innerText = `LVL ${state.level}`;
        document.getElementById('ui-maxbet').innerText = `Max: ${state.maxBet.toLocaleString()}`;
        document.getElementById('ui-click-rate').innerText = state.clickPower;
    }

    function doWork() {
        addMoney(state.clickPower);
    }
    
    function upgradeClick() {
        if(state.money >= 250) {
            addMoney(-250);
            state.clickPower += 5;
            updateUI();
            showToast("–î–æ—Ö–æ–¥ —É–≤–µ–ª–∏—á–µ–Ω!");
        } else {
            showToast("–ù—É–∂–Ω–æ 250 PLN");
        }
    }

    function openGame(id) {
        if(!games[id]) return;
        currentGameId = id;
        document.getElementById('view-lobby').classList.remove('active');
        document.getElementById('view-gameroom').classList.add('active');
        
        let container = document.getElementById('game-engine-container');
        container.innerHTML = `<h2 style="margin:0">${games[id].title}</h2>` + games[id].render();
    }

    function closeGame() {
        currentGameId = null;
        document.getElementById('view-gameroom').classList.remove('active');
        document.getElementById('view-lobby').classList.add('active');
    }

    function switchTab(id, el) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        if(id === 'lobby') {
            if(currentGameId) closeGame(); // If switching to lobby while in game
            else document.getElementById('view-lobby').classList.add('active');
        } else {
            document.getElementById('view-' + id).classList.add('active');
        }

        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        if(el) el.classList.add('active');
    }

    function showToast(msg, type) {
        let t = document.getElementById('toast');
        t.innerHTML = msg;
        t.className = type === 'win' ? 'win' : (type === 'lose' ? 'lose' : '');
        t.style.opacity = 1;
        setTimeout(() => t.style.opacity = 0, 2000);
    }

    function resetGame() {
        if(confirm("–°–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å?")) {
            localStorage.removeItem(KEY);
            location.reload();
        }
    }

    init();
</script>
</body>
</html>

