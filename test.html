<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Warszawa Cyber-Tycoon</title>
    <style>
        :root {
            --bg: #050505;
            --panel: rgba(20, 20, 20, 0.8);
            --neon-blue: #00f3ff;
            --neon-pink: #ff00ff;
            --neon-green: #00ff41;
            --danger: #ff3333;
            --text-main: #e0e0e0;
        }

        body {
            background-color: var(--bg);
            color: var(--text-main);
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            background-image: 
                linear-gradient(rgba(0, 255, 65, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 65, 0.03) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* --- UI HEADER --- */
        .hud-top {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            background: var(--panel);
            border-bottom: 1px solid var(--neon-blue);
            z-index: 100;
        }

        .stat-box {
            text-align: center;
        }

        .crypto-val {
            font-size: 20px;
            font-weight: bold;
            color: var(--neon-green);
            text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
        }

        .temp-bar-container {
            width: 100%;
            height: 4px;
            background: #333;
            margin-top: 5px;
            position: relative;
        }
        
        .temp-bar-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--neon-blue), var(--danger));
            transition: width 0.2s;
        }

        /* --- CORE VISUAL (–ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–æ –∏–∑ —Ç–≤–æ–µ–≥–æ test.html) --- */
        .core-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            perspective: 1000px;
        }

        .avatar-frame {
            width: 280px;
            height: 280px;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: transform 0.1s;
        }

        .avatar-frame:active {
            transform: scale(0.95);
        }

        .core {
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, #fff 10%, var(--neon-blue) 60%, #000 90%);
            border-radius: 50%;
            position: absolute;
            z-index: 10;
            box-shadow: 0 0 50px var(--neon-blue);
            animation: pulse 2s infinite ease-in-out;
        }

        .orbit {
            position: absolute;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .orbit-1 { width: 160px; height: 160px; border-top: 2px solid var(--neon-blue); animation: spin 4s linear infinite; }
        .orbit-2 { width: 220px; height: 220px; border-bottom: 2px solid var(--neon-pink); animation: spin-rev 7s linear infinite; }
        .orbit-3 { width: 260px; height: 260px; border-left: 2px dashed var(--neon-green); animation: spin 12s linear infinite; }

        @keyframes pulse { 0% { transform: scale(0.95); opacity: 0.8; } 50% { transform: scale(1.05); opacity: 1; box-shadow: 0 0 80px var(--neon-blue); } 100% { transform: scale(0.95); opacity: 0.8; } }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes spin-rev { 0% { transform: rotate(360deg); } 100% { transform: rotate(0deg); } }

        .heat-warning {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 40px;
            color: var(--danger);
            font-weight: 900;
            display: none;
            z-index: 20;
            text-shadow: 0 0 20px var(--danger);
            pointer-events: none;
            border: 4px solid var(--danger);
            padding: 20px;
            background: rgba(0,0,0,0.8);
        }

        /* --- STRATEGY PANEL --- */
        .strategy-panel {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .mode-btn {
            background: transparent;
            border: 1px solid #555;
            color: #777;
            padding: 8px 15px;
            font-family: inherit;
            font-size: 10px;
            cursor: pointer;
            text-transform: uppercase;
        }

        .mode-btn.active {
            border-color: var(--color);
            color: var(--color);
            box-shadow: 0 0 10px var(--color);
        }

        /* --- UPGRADES --- */
        .panel-bottom {
            background: var(--panel);
            border-top: 1px solid var(--neon-pink);
            height: 35vh;
            overflow-y: auto;
            padding: 15px;
        }

        .upgrade-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255,255,255,0.05);
            padding: 10px;
            margin-bottom: 10px;
            border-left: 3px solid #555;
        }

        .upgrade-card.affordable {
            border-left-color: var(--neon-green);
        }

        .btn-buy {
            background: transparent;
            border: 1px solid var(--neon-green);
            color: var(--neon-green);
            padding: 5px 10px;
            cursor: pointer;
            font-weight: bold;
        }
        .btn-buy:disabled {
            border-color: #555;
            color: #555;
        }

        /* --- LOGS --- */
        .log-console {
            position: absolute;
            top: 70px;
            left: 10px;
            font-size: 10px;
            color: var(--neon-green);
            opacity: 0.7;
            pointer-events: none;
            text-shadow: 0 0 2px var(--neon-green);
        }
        .log-line { margin-bottom: 2px; }

    </style>
</head>
<body>

    <div class="hud-top">
        <div class="stat-box" style="text-align: left;">
            <small style="color:var(--neon-blue)">NET_WORTH</small><br>
            <span id="crypto-ui" class="crypto-val">0.0000</span> BTC
        </div>
        <div class="stat-box" style="text-align: right; width: 120px;">
            <small style="color:var(--danger)">SYS_TEMP</small> <span id="temp-val-ui">0¬∞C</span>
            <div class="temp-bar-container">
                <div id="temp-bar" class="temp-bar-fill"></div>
            </div>
            <small id="cooling-rate-ui" style="font-size: 9px; color: #777;">Cooling: -1¬∞/sec</small>
        </div>
    </div>

    <div class="log-console" id="log-container">
        <div class="log-line">> SYSTEM INIT...</div>
    </div>

    <div class="core-container">
        <div class="heat-warning" id="overheat-msg">OVERHEAT</div>
        <div class="avatar-frame" id="click-zone" onclick="manualHack()">
            <div class="core"></div>
            <div class="orbit orbit-1"></div>
            <div class="orbit orbit-2"></div>
            <div class="orbit orbit-3"></div>
        </div>
    </div>

    <div style="text-align: center; margin-bottom: 10px; color: #aaa; font-size: 10px;">
        –†–ï–ñ–ò–ú –†–ê–ë–û–¢–´ (–°–¢–†–ê–¢–ï–ì–ò–Ø)
    </div>
    <div class="strategy-panel">
        <button class="mode-btn" style="--color: var(--neon-blue)" id="mode-eco" onclick="setMode('eco')">‚ùÑÔ∏è ECO</button>
        <button class="mode-btn active" style="--color: var(--neon-green)" id="mode-normal" onclick="setMode('normal')">‚ö° NORMAL</button>
        <button class="mode-btn" style="--color: var(--danger)" id="mode-oc" onclick="setMode('overclock')">üî• OVERCLOCK</button>
    </div>

    <div class="panel-bottom">
        <div style="font-size: 12px; margin-bottom: 10px; color: var(--neon-pink); font-weight: bold;">/// MARKETPLACE ///</div>
        <div id="upgrades-list"></div>
    </div>

<script>
    // === LOGIC & ECONOMY ===
    
    // Save Key (Compatible logic pattern)
    const SAVE_KEY = "WARSZAWA_CYBER_SAVE";

    const MODES = {
        eco: { mult: 0.5, heat: 0.2, color: 'var(--neon-blue)' },
        normal: { mult: 1.0, heat: 1.0, color: 'var(--neon-green)' },
        overclock: { mult: 3.5, heat: 4.0, color: 'var(--danger)' }
    };

    const UPGRADES = [
        { id: 'ram', name: 'RAM Stick 8GB', desc: '+–ë–∞–∑–∞ –∫–ª–∏–∫–∞', basePrice: 0.005, type: 'click', val: 0.0001 },
        { id: 'gpu', name: 'GTX 1050 Miner', desc: '+–ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥', basePrice: 0.020, type: 'auto', val: 0.0005, heatGen: 0.5 },
        { id: 'fan', name: 'Cooler Master', desc: '+–û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ', basePrice: 0.015, type: 'cool', val: 1.5 },
        { id: 'asic', name: 'ASIC Antminer', desc: '++–ü–∞—Å—Å–∏–≤, +–ñ–∞—Ä', basePrice: 0.150, type: 'auto', val: 0.005, heatGen: 3.0 },
        { id: 'liquid', name: 'Liquid Cooling', desc: '++–û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ', basePrice: 0.300, type: 'cool', val: 5.0 },
        { id: 'server', name: 'Mainframe Node', desc: '+++–ü–∞—Å—Å–∏–≤, ++–ñ–∞—Ä', basePrice: 1.000, type: 'auto', val: 0.05, heatGen: 10.0 }
    ];

    let G = {
        btc: 0.0000,
        temp: 40,
        clickPower: 0.0001,
        autoPower: 0,
        cooling: 2.0, // –ë–∞–∑–æ–≤–æ–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ
        heatGeneration: 0, // –ë–∞–∑–æ–≤—ã–π –Ω–∞–≥—Ä–µ–≤ –æ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
        inventory: {},
        startTime: Date.now()
    };

    let currentMode = 'normal';
    let isOverheated = false;

    // --- INIT ---
    function init() {
        loadGame();
        renderUpgrades();
        setInterval(gameLoop, 100); // Fast loop for smooth bars
        setInterval(saveGame, 5000); // Auto save
        log("System Online. Welcome, NetRunner.");
    }

    // --- CORE LOOP ---
    function gameLoop() {
        // –û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å–µ–≥–¥–∞
        let coolingEffect = G.cooling * 0.1; // per tick (0.1s)
        
        // –ù–∞–≥—Ä–µ–≤ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–∞—Å—Å–∏–≤–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –∏ —Ä–µ–∂–∏–º–∞
        let passiveHeat = (G.heatGeneration * MODES[currentMode].heat) * 0.1;
        
        // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
        if (!isOverheated) {
            G.temp = G.temp + passiveHeat - coolingEffect;
            
            // –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥
            if (G.autoPower > 0) {
                let gain = (G.autoPower * MODES[currentMode].mult) * 0.1;
                G.btc += gain;
            }
        } else {
            // –ï—Å–ª–∏ –ø–µ—Ä–µ–≥—Ä–µ–≤, –¥–æ—Ö–æ–¥ 0, –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ —Ö2 (–∞–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º)
            G.temp -= coolingEffect * 1.5;
            if (G.temp <= 50) {
                isOverheated = false;
                document.getElementById('overheat-msg').style.display = 'none';
                log("System Restored.");
            }
        }

        // –§–∏–∑–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
        if (G.temp < 20) G.temp = 20; // –ö–æ–º–Ω–∞—Ç–Ω–∞—è
        if (G.temp > 100) {
            G.temp = 100;
            if (!isOverheated) {
                isOverheated = true;
                document.getElementById('overheat-msg').style.display = 'block';
                log("CRITICAL ERROR: OVERHEAT!", "red");
                // –°–±—Ä–æ—Å —Ä–µ–∂–∏–º–∞ –Ω–∞ Eco –ø—Ä–∏ –ø–µ—Ä–µ–≥—Ä–µ–≤–µ
                setMode('eco'); 
            }
        }

        updateUI();
    }

    // --- ACTIONS ---
    function manualHack() {
        if (isOverheated) return;

        // –ö–ª–∏–∫ –Ω–∞–≥—Ä–µ–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä!
        let heatCost = 2.5 * MODES[currentMode].heat; 
        G.temp += heatCost;

        let gain = G.clickPower * MODES[currentMode].mult;
        G.btc += gain;

        createFloatingText(`+${gain.toFixed(5)}`, MODES[currentMode].color);
        
        // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –∫–ª–∏–∫–∞
        const core = document.querySelector('.core');
        core.style.transform = 'scale(1.2)';
        setTimeout(() => core.style.transform = 'scale(1)', 100);
    }

    function setMode(mode) {
        currentMode = mode;
        document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
        
        let btnId = mode === 'eco' ? 'mode-eco' : mode === 'normal' ? 'mode-normal' : 'mode-oc';
        document.getElementById(btnId).classList.add('active');
        
        log(`Mode switched to: ${mode.toUpperCase()}`);
    }

    function buyUpgrade(id) {
        let item = UPGRADES.find(u => u.id === id);
        let count = G.inventory[id] || 0;
        let cost = item.basePrice * Math.pow(1.15, count);

        if (G.btc >= cost) {
            G.btc -= cost;
            G.inventory[id] = count + 1;
            
            // Apply Stats
            if (item.type === 'click') G.clickPower += item.val;
            if (item.type === 'auto') {
                G.autoPower += item.val;
                G.heatGeneration += (item.heatGen || 0);
            }
            if (item.type === 'cool') G.cooling += item.val;

            log(`Installed: ${item.name} (Lvl ${count + 1})`);
            renderUpgrades();
            saveGame();
        } else {
            log("Insufficient Funds", "red");
        }
    }

    // --- UI & RENDER ---
    function updateUI() {
        document.getElementById('crypto-ui').innerText = G.btc.toFixed(6);
        
        let tempPct = Math.min(100, Math.max(0, G.temp));
        let bar = document.getElementById('temp-bar');
        document.getElementById('temp-val-ui').innerText = Math.floor(G.temp) + "¬∞C";
        bar.style.width = tempPct + "%";

        // –¶–≤–µ—Ç –ø–æ–ª–æ—Å–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
        if (tempPct < 60) bar.style.background = "var(--neon-blue)";
        else if (tempPct < 85) bar.style.background = "var(--neon-green)";
        else bar.style.background = "var(--danger)";

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ (–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å)
        UPGRADES.forEach(u => {
            let count = G.inventory[u.id] || 0;
            let cost = u.basePrice * Math.pow(1.15, count);
            let btn = document.getElementById(`btn-${u.id}`);
            if(btn) {
                btn.disabled = G.btc < cost;
                if (!btn.disabled) btn.parentElement.classList.add('affordable');
                else btn.parentElement.classList.remove('affordable');
            }
        });

        // –†–∞—Å—á–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è UI
        let netHeat = ((G.heatGeneration * MODES[currentMode].heat) - G.cooling);
        let sign = netHeat > 0 ? "+" : "";
        let color = netHeat > 0 ? "var(--danger)" : "var(--neon-blue)";
        document.getElementById('cooling-rate-ui').innerHTML = `Net Heat: <span style="color:${color}">${sign}${netHeat.toFixed(1)}¬∞/sec</span>`;
    }

    function renderUpgrades() {
        const list = document.getElementById('upgrades-list');
        list.innerHTML = "";
        UPGRADES.forEach(u => {
            let count = G.inventory[u.id] || 0;
            let cost = u.basePrice * Math.pow(1.15, count);
            
            let heatInfo = "";
            if (u.type === 'auto') heatInfo = `<span style="color:var(--danger)">üî• +${u.heatGen} Heat</span>`;
            if (u.type === 'cool') heatInfo = `<span style="color:var(--neon-blue)">‚ùÑÔ∏è -${u.val} Heat</span>`;

            list.innerHTML += `
            <div class="upgrade-card">
                <div>
                    <div style="font-weight:bold; color:#fff;">${u.name} <span style="font-size:10px; color:#777;">Lvl ${count}</span></div>
                    <div style="font-size:10px; color:#aaa;">${u.desc} ${heatInfo}</div>
                </div>
                <button id="btn-${u.id}" class="btn-buy" onclick="buyUpgrade('${u.id}')">
                    ${cost.toFixed(4)} ‚Çø
                </button>
            </div>
            `;
        });
    }

    // --- UTILS ---
    function log(msg, color = null) {
        const c = document.getElementById('log-container');
        const l = document.createElement('div');
        l.className = 'log-line';
        l.innerText = `> ${msg}`;
        if (color) l.style.color = color;
        c.prepend(l);
        if (c.children.length > 6) c.lastChild.remove();
    }

    function createFloatingText(text, color) {
        const el = document.createElement('div');
        el.innerText = text;
        el.style.position = 'absolute';
        el.style.left = '50%';
        el.style.top = '50%';
        el.style.transform = 'translate(-50%, -50%)';
        el.style.color = color;
        el.style.fontWeight = 'bold';
        el.style.fontSize = '20px';
        el.style.pointerEvents = 'none';
        el.style.textShadow = `0 0 5px ${color}`;
        el.style.transition = 'all 1s ease-out';
        
        document.querySelector('.core-container').appendChild(el);
        
        setTimeout(() => {
            el.style.top = '30%';
            el.style.opacity = 0;
        }, 50);
        setTimeout(() => el.remove(), 1000);
    }

    function saveGame() {
        localStorage.setItem(SAVE_KEY, JSON.stringify(G));
    }

    function loadGame() {
        let d = localStorage.getItem(SAVE_KEY);
        if (d) {
            try {
                let loaded = JSON.parse(d);
                G = { ...G, ...loaded };
                // –°–±—Ä–æ—Å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ, —á—Ç–æ–±—ã –Ω–µ —Å–≥–æ—Ä–µ—Ç—å —Å—Ä–∞–∑—É
                G.temp = 40; 
                isOverheated = false;
            } catch (e) { console.error("Save Corrupted"); }
        }
    }

    window.onload = init;

</script>
</body>
</html>

